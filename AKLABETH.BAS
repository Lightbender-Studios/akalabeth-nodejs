0 ONERR GOTO 20
10 REM
20 PR# 0: IN# 0
30 HIMEM: 49151
40 CLEAR : GOSUB 3430
50 ZZ = RND ( - ABS (LN))
60 LEVEL = 0
70 TEXT : HOME : NORMAL : VTAB (12): PRINT " WELCOME TO AKALABETH, WORLD OF DOOM!"
80 DIM DN%(10,10),TE%(20,20),XX%(10),YY%(10),PER%(10,3),LD%(10,5),CD%(1 0,3),FT%(10,5),LAD%(10,3)
90 FOR X = 0 TO 20:TE%(X,0) = 1:TE%(0,X) = 1:TE%(X,20) = 1:TE%(20,X) = 1: NEXT
100 : VTAB (23): PRINT " (PLEASE WAIT)";
110 FOR X = 1 TO 19: FOR Y = 1 TO 19:TE%(X,Y) = INT ( RND (1) ^ 5 * 4.5 )
120 IF TE%(X,Y) = 3 AND RND (1) > .5 THEN TE%(X,Y) = 0
130 NEXT : PRINT ".";: NEXT
140 TE%( INT ( RND (1) * 19 + 1), INT ( RND (1) * 19 + 1)) = 5:TX = INT ( RND (1) * 19 + 1):TY = INT ( RND (1) * 19 + 1):TE%(TX,TY) = 3
150 XX%(0) = 139:YY%(0) = 79
160 FOR X = 2 TO 20 STEP 2:XX%(X / 2) = INT ( ATN (1 / X) / ATN (1) * 140 + .5):YY%(X / 2) = INT (XX%(X / 2) * 4 / 7)
170 PER%(X / 2,0) = 139 - XX%(X / 2):PER%(X / 2,1) = 139 + XX%(X / 2):PER %(X / 2,2) = 79 - YY%(X / 2):PER%(X / 2,3) = 79 + YY%(X / 2): NEXT
180 PER%(0,0) = 0:PER%(0,1) = 279:PER%(0,2) = 0:PE%(0,3) = 159
190 FOR X = 1 TO 10:CD%(X,0) = 139 - XX%(X) / 3:CD%(X,1) = 139 + XX%(X) / 3:CD%(X,2) = 79 - YY%(X) * .7:CD%(X,3) = 79 + YY%(X): NEXT : PRINT " .";
200 FOR X = 0 TO 9:LD%(X,0) = (PER%(X,0) * 2 + PER%(X + 1,0)) / 3:LD%(X, 1) = (PER%(X,0) + 2 * PER%(X + 1,0)) / 3:W = LD%(X,0) - PE%(X,0)
210 LD%(X,2) = PE%(X,2) + W * 4 / 7:LD%(X,3) = PER%(X,2) + 2 * W * 4 / 7: LD%(X,4) = (PE%(X,3) * 2 + PE%(X + 1,3)) / 3:LD%(X,5) = (PE%(X,3) + 2 * PE%(X + 1,3)) / 3
220 LD%(X,2) = LD%(X,4) - (LD%(X,4) - LD%(X,2)) * .8:LD%(X,3) = LD%(X,5) - (LD%(X,5) - LD%(X,3)) * .8: IF LD%(X,3) = LD%(X,4) THEN LD%(X,3) = L D%(X,3) - 1
230 NEXT
240 FOR X = 0 TO 9:FT%(X,0) = 139 - XX%(X) / 3:FT%(X,1) = 139 + XX%(X) / 3:FT%(X,2) = 139 - XX%(X + 1) / 3:FT%(X,3) = 139 + XX%(X + 1) / 3
250 FT%(X,4) = 79 + (YY%(X) * 2 + YY%(X + 1)) / 3:FT%(X,5) = 79 + (YY%(X) + 2 * YY%(X + 1)) / 3: NEXT
260 FOR X = 0 TO 9:LAD%(X,0) = (FT%(X,0) * 2 + FT%(X,1)) / 3:LAD%(X,1) = (FT%(X,0) + 2 * FT%(X,1)) / 3:LAD%(X,3) = FT%(X,4):LAD%(X,2) = 159 - LAD%(X,3): NEXT
270 HOME : HCOLOR= 3
280 POKE 34,20: POKE 33,29: HOME
290 GOSUB 310: GOTO 1710
300 FOR X = 0 TO 9: FOR Y = 0 TO 5: PRINT LD%(X,Y);" ";: NEXT : PRINT : NEXT : GET Q$
310 HGR : FOR Y = - 1 TO 1: FOR X = - 1 TO 1
320 HPLOT 138,75 TO 142,75: HPLOT 140,73 TO 140,77
330 ZZ = TER%(TX + X,TY + Y):X1 = 65 + (X + 1) * 50:Y1 = (Y + 1) * 50
340 IF ZZ = 2 THEN HPLOT X1 + 20,Y1 + 20 TO X1 + 30,Y1 + 20 TO X1 + 30 ,Y1 + 30 TO X1 + 20,Y1 + 30 TO X1 + 20,Y1 + 20
350 IF ZZ = 3 THEN HPLOT X1 + 10,Y1 + 10 TO X1 + 20,Y1 + 10 TO X1 + 20 ,Y1 + 40 TO X1 + 10,Y1 + 40 TO X1 + 10,Y1 + 30
360 IF ZZ = 3 THEN HPLOT X1 + 40,Y1 + 30 TO X1 + 40,Y1 + 40 TO X1 + 30,Y1 + 40 TO X1 + 30,Y1 + 10 TO X1 + 40,Y1 + 10
370 IF ZZ = 3 THEN HPLOT X1 + 40,Y1 + 20 TO X1 + 10,Y1 + 20 TO X1 + 10,Y1 + 10
380 IF ZZ = 4 THEN HPLOT X1 + 20,Y1 + 20 TO X1 + 30,Y1 + 30: HPLOT X1 + 20,Y1 + 30 TO X1 + 30,Y1 + 20
390 IF ZZ = 5 THEN HPLOT X1,Y1 TO X1 + 50,Y1 TO X1 + 50,Y1 + 50 TO X1, Y1 + 50 TO X1,Y1
400 : HPLOT X1 + 10,Y1 + 10 TO X1 + 10,Y1 + 40 TO X1 + 4 0,Y1 + 40 TO X1 + 40,Y1 + 10 TO X1 + 10,Y1 + 10 TO X1 + 40,Y1 + 40: HPLOT X1 + 10,Y1 + 40 TO X1 + 40,Y1 + 10
410 IF ZZ = 1 THEN HPLOT X1 + 10,Y1 + 50 TO X1 + 10,Y1 + 40 TO X1 + 20 ,Y1 + 30 TO X1 + 40,Y1 + 30 TO X1 + 40,Y1 + 50
420 HPLOT X1,Y1 + 10 TO X1 + 10,Y1 + 10: HPLOT X1 + 50,Y1 + 10 TO X1 + 40,Y1 + 10: HPLOT X1, Y1 + 40 TO X1 + 10,Y1 + 40: HPLOT X1 + 40,Y1 + 40 TO X1 + 50,Y1 + 40
430 IF ZZ = 1 THEN HPLOT X1 + 10,Y1 TO X1 + 10,Y1 + 20 TO X1 + 20,Y1 + 20 TO X1 + 20,Y1 + 30 TO X1 + 30,Y1 + 30 TO X1 + 30,Y1 + 10 TO X1 + 40,Y1 + 10 TO X1 + 40,Y1
440 NEXT : NEXT : RETURN
450 HGR :DIS = 0: HCOLOR= 3
460 CENT = DNG%(PX + DX * DIS,PY + DY * DIS):LEFT = DNG%(PX + DX * DIS + DY,PY + DY * DIS - DX):RIGH = DNG%(PX + DX * DIS - DY,PY + DY * DIS + DX)
470 L1 = PER%(DIS,0):R1 = PER%(DIS,1):T1 = PER%(DIS,2):B1 = PER%(DIS,3): L2 = PER%(DIS + 1,0):R2 = PER%(DIS + 1,1):T2 = PER%(DIS + 1,2):B2 = PER%(DIS + 1,3)
480 CENT = INT (CENT):LEFT = INT (LEFT):RIGHT = INT (RIGHT)
490 MC = INT (CENT / 10):CENT = CENT - MC * 10:LEFT = INT ((LEFT / 10 - INT (LEF / 10)) * 10 + .1):RIGH = INT ((RIGH / 10 - INT (RIG / 10 )) * 10 + .1)
500 IF DIS = 0 THEN 540
510 IF CENT = 1 OR CENT = 3 OR CENT = 4 THEN HPLOT L1,T1 TO R1,T1 TO R 1,B1 TO L1,B1 TO L1,T1
520 IF CENT = 1 OR CENT = 3 THEN EN = 1: GOTO 740
530 IF CENT = 4 THEN HPLOT CD%(DIS,0),CD%(DIS,3) TO CD%(DIS,0),CD%(DIS ,2) TO CD%(DIS,1),CD%(DIS,2) TO CD%(DIS,1),CD%(DIS,3):EN = 1: GOTO 740
540 IF LEFT = 1 OR LEFT = 3 OR LEFT = 4 THEN HPLOT L1,T1 TO L2,T2: HPLOT L1,B1 TO L2,B2
550 IF RIGH = 1 OR RIGH = 3 OR RIGH = 4 THEN HPLOT R1,T1 TO R2,T2: HPLOT R1,B1 TO R2,B2
560 IF LEFT = 4 AND DIS > 0 THEN HPLOT LD%(DIS,0),LD%(DIS,4) TO LD%(DI S,0),LD%(DIS,2) TO LD%(DIS,1),LD%(DIS,3) TO LD%(DIS,1),LD%(DIS,5)
570 IF LEFT = 4 AND DIS = 0 THEN HPLOT 0,LD%(DIS,2) - 3 TO LD%(DIS,1), LD%(DIS,3) TO LD%(DIS,1),LD%(DIS,5)
580 IF RIGH = 4 AND DIS > 0 THEN HPLOT 279 - LD%(DIS,0),LD%(DIS,4) TO 279 - LD%(DIS,0),LD%(DIS,2) TO 279 - LD%(DIS,1),LD%(DIS,3) TO 279 - LD%(DIS,1),LD%(DIS,5)
590 IF RIGH = 4 AND DIS = 0 THEN HPLOT 279,LD%(DIS,2) - 3 TO 279 - LD% (DIS,1),LD%(DIS,3) TO 279 - LD%(DIS,1),LD%(DIS,5)
600 IF LEFT = 3 OR LEFT = 1 OR LEFT = 4 THEN 630
610 IF DIS < > 0 THEN HPLOT L1,T1 TO L1,B1
620 HPLOT L1,T2 TO L2,T2 TO L2,B2 TO L1,B2
630 IF RIGH = 3 OR RIGH = 1 OR RIGH = 4 THEN 660
640 IF DIS < > 0 THEN HPLOT R1,T1 TO R1,B1
650 HPLOT R1,T2 TO R2,T2 TO R2,B2 TO R1,B2
660 IF CENT = 7 OR CENT = 9 THEN HPLOT FT%(DIS,0),FT%(DIS,4) TO FT%(DI S,2),FT%(DIS,5) TO FT%(DIS,3),FT%(DIS,5) TO FT%(DIS,1),FT%(DIS,4) TO FT%(DIS,0),FT%(DIS,4)
670 IF CENT = 8 THEN HPLOT FT%(DIS,0),158 - FT%(DIS,4) TO FT%(DIS,2),1 58 - FT%(DIS,5) TO FT%(DIS,3),158 - FT%(DIS,5) TO FT%(DIS,1),158 - F T%(DIS,4) TO FT%(DIS,0),158 - FT%(DIS,4)
680 IF CENT = 7 OR CENT = 8 THEN BASE = LAD%(DIS,3):TP = LAD%(DIS,2):LX = LAD%(DIS,0):RX = LAD%(DIS,1): HPLOT LX,BA TO LX,TP: HPLOT RX,TP TO RX,BA
690 IF CENT = 7 OR CENT = 8 THEN Y1 = (BA * 4 + TP) / 5:Y2 = (BA * 3 + TP * 2) / 5:Y3 = (BA * 2 + TP * 3) / 5:Y4 = (BA + TP * 4) / 5: HPLOT LX,Y1 TO RX,Y1: HPLOT LX,Y2 TO RX,Y2: HPLOT LX,Y3 TO RX,Y3: HPLOT LX ,Y4 TO RX,Y4
700 IF DIS > 0 AND CENT = 5 THEN HPLOT 139 - 10 / DIS,PER%(DIS,3) TO 1 39 - 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 10 / DIS,PER%(DIS,3) TO 139 - 10 / DIS,PER%(DIS,3)
710 IF CENT = 5 AND DIS > 0 THEN INVERSE : PRINT "CHEST!": NORMAL
720 IF DIS > 0 AND CENT = 5 THEN HPLOT 139 - 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 - 5 / DIS,PER%(DIS,3) - 15 / DIS TO 139 + 15 / DIS,PER %(DIS,3) - 15 / DIS TO 139 + 15 / DIS,PER%(DIS,3) - 5 / DIS TO 139 + 10 / DIS,PER%(DIS,3)
730 IF DIS > 0 AND CENT = 5 THEN HPLOT 139 + 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 15 / DIS,PER%(DIS,3) - 15 / DIS
740 IF MC < 1 THEN 1480
750 B = 79 + YY%(DIS):C = 139
760 INVERSE : IF MC = 8 THEN PRINT "CHEST!";: CALL - 868: PRINT : NORMAL : GOTO 780
770 PRINT M$(MC);: CALL - 868: PRINT : NORMAL
780 IF DIS = 0 THEN 1480
790 ON MC GOTO 810,880,920,980,1060,1140,1210,1250,1290,1370
800 GOTO 1480
810 HPLOT C - 23 / DIS,B TO C - 15 / DIS,B TO C - 15 / DI,B - 15 / DI TO C - 8 / DI,B - 30 / DI TO C + 8 / DI,B - 30 / DI TO C + 15 / DI,B - 15 / DI TO C + 15 / DI,B TO C + 23 / DI,B
820 HPLOT C,B - 26 / DI TO C,B - 65 / DI: HPLOT C - 2 / DI + .5,B - 38 / DI TO C + 2 / DI + .5,B - 38 / DI: HPLOT C - 3 / DI + .5,B - 45 / DI TO C + 3 / DI + .5,B - 45 / DI: HPLOT C - 5 / DI + .5,B - 53 / DI TO C + 5 / DI + .5,B - 53 / DI
830 HPLOT C - 23 / DI,B - 56 / DI TO C - 30 / DI,B - 53 / DI TO C - 23 / DI,B - 45 / DI TO C - 23 / DI,B - 53 / DI TO C - 8 / DI,B - 38 / DI
840 HPLOT C - 15 / DI,B - 45 / DI TO C - 8 / DI,B - 60 / DI TO C + 8 / DI,B - 60 / DI TO C + 15 / DI,B - 45 / DI: HPLOT C + 15 / DI,B - 42 / DI TO C + 15 / DI,B - 57 / DI: HPLOT C + 12 / DI,B - 45 / DI TO C + 20 / DI,B - 45 / DI
850 HPLOT C,B - 75 / DI TO C - 5 / DI + .5,B - 80 / DI TO C - 8 / DI,B - 75 / DI TO C - 5 / DI + .5,B - 65 / DI TO C + 5 / DI + .5,B - 65 / D I TO C + 5 / DI + .5,B - 68 / DI TO C - 5 / DI + .5,B - 68 / DI TO C - 5 / DI + .5,B - 65 / DI
860 HPLOT TO C + 5 / DI + .5,B - 65 / DI TO C + 8 / DI,B - 75 / DI TO C + 5 / DI + .5,B - 80 / DI TO C - 5 / DI + .5,B - 80 / DI: HPLOT C - 5 / DI + .5,B - 72 / DI: HPLOT C + 5 / DI + .5,B - 72 / DI
870 GOTO 1480
880 HPLOT C,B - 56 / DI TO C,B - 8 / DI TO C + 10 / DI,B TO C + 30 / DI ,B TO C + 30 / DI,B - 45 / DI TO C + 10 / DI,B - 64 / DI TO C,B - 56 / DI
890 HPLOT TO C - 10 / DI,B - 64 / DI TO C - 30 / DI,B - 45 / DI TO C - 30 / DI,B TO C - 10 / DI,B TO C,B - 8 / DI
900 HPLOT C - 10 / DI,B - 64 / DI TO C - 10 / DI,B - 75 / DI TO C,B - 8 3 / DI TO C + 10 / DI,B - 75 / DI TO C,B - 79 / DI TO C - 10 / DI,B - 75 / DI TO C,B - 60 / DI TO C + 10 / DI,B - 75 / DI TO C + 10 / DI,B - 64 / DI
910 GOTO 1480
920 HPLOT C + 5 / DI,B - 30 / DI TO C,B - 25 / DI TO C - 5 / DI,B - 30 / DI TO C - 15 / DI,B - 5 / DI TO C - 10 / DI,B TO C + 10 / DI,B TO C + 15 / DI,B - 5 / DI
930 HPLOT TO C + 20 / DI,B - 5 / DI TO C + 10 / DI,B TO C + 15 / DI,B - 5 / DI TO C + 5 / DI,B - 30 / DI TO C + 10 / DI,B - 40 / DI TO C + 3 / DI + .5,B - 35 / DI
950 HPLOT TO C - 3 / DI + .5,B - 35 / DI TO C - 10 / DI ,B - 40 / DI TO C - 5 / DI,B - 30 / DI
955 HPLOT C - 5 / DI,B - 33 / DI TO C - 3 / DI + .5,B - 30 / DI: HPLOT C + 5 / DI,B - 33 / DI TO C + 3 / DI + .5,B - 30 / DI: HPLOT C - 5 / DI,B - 20 / DI TO C - 5 / DI,B - 15 / DI
960 HPLOT C + 5 / DI,B - 20 / DI TO C + 5 / DI,B - 15 / DI: HPLOT C - 7 / DI,B - 20 / DI TO C - 7 / DI,B - 15 / DI: HPLOT C + 7 / DI,B - 20 / DI TO C + 7 / DI,B - 15 / DI
970 GOTO 1480
980 HPLOT C,B TO C - 15 / DI,B TO C - 8 / DI,B - 8 / DI TO C - 8 / DI,B - 15 / DI TO C - 15 / DI,B - 23 / DI TO C - 15 / DI,B - 15 / DI TO C - 23 / DI,B - 23 / DI
990 HPLOT TO C - 23 / DI,B - 45 / DI TO C - 15 / DI,B - 53 / DI TO C - 8 / DI,B - 53 / DI TO C - 15 / DI,B - 68 / DI TO C - 8 / DI,B - 75 / DI TO C,B - 75 / DI
1000 HPLOT C,B TO C + 15 / DI,B TO C + 8 / DI,B - 8 / DI TO C + 8 / DI,B - 15 / DI TO C + 15 / DI,B - 23 / DI TO C + 15 / DI,B - 15 / DI TO C + 23 / DI,B - 23 / DI
1010 HPLOT TO C + 23 / DI,B - 45 / DI TO C + 15 / DI,B - 53 / DI TO C + 8 / DI,B - 53 / DI TO C + 15 / DI,B - 68 / DI TO C + 8 / DI,B - 75 / DI TO C,B - 75 / DI
1020 HPLOT C - 15 / DI,B - 68 / DI TO C + 15 / DI,B - 68 / DI: HPLOT C - 8 / DI,B - 53 / DI TO C + 8 / DI,B - 53 / DI: HPLOT C - 23 / DI,B - 15 / DI TO C + 8 / DI,B - 45 / DI
1030 HPLOT C - 8 / DI,B - 68 / DI TO C,B - 60 / DI TO C + 8 / DI,B - 68 / DI TO C + 8 / DI,B - 60 / DI TO C - 8 / DI,B - 60 / DI TO C - 8 / DI ,B - 68 / DI
1040 HPLOT C,B - 38 / DI TO C - 8 / DI,B - 38 / DI TO C + 8 / DI,B - 53 / DI TO C + 8 / DI,B - 45 / DI TO C + 15 / DI,B - 45 / DI TO C,B - 30 / DI TO C,B - 38 / DI
1050 GOTO 1480
1060 HPLOT C - 10 / DI,B - 15 / DI TO C - 10 / DI,B - 30 / DI TO C - 15 / DI,B - 20 / DI TO C - 15 / DI,B - 15 / DI TO C - 15 / DI,B TO C + 15 / DI,B TO C + 15 / DI,B - 15 / DI TO C - 15 / DI,B - 15 / DI
1070 HPLOT C - 15 / DI,B - 10 / DI TO C + 15 / DI,B - 10 / DI: HPLOT C - 15 / DI,B - 5 / DI TO C + 15 / DI,B - 5 / DI
1080 HPLOT C,B - 15 / DI TO C - 5 / DI,B - 20 / DI TO C - 5 / DI,B - 35 / DI TO C + 5 / DI,B - 35 / DI TO C + 5 / DI,B - 20 / DI TO C + 10 / D I,B - 15 / DI
1090 HPLOT C - 5 / DI,B - 20 / DI TO C + 5 / DI,B - 20 / DI: HPLOT C - 5 / DI,B - 25 / DI TO C + 5 / DI,B - 25 / DI: HPLOT C - 5 / DI,B - 30 / DI TO C + 5 / DI,B - 30 / DI
1100 HPLOT C - 10 / DI,B - 35 / DI TO C - 10 / DI,B - 40 / DI TO C - 5 / DI,B - 45 / DI TO C + 5 / DI,B - 45 / DI TO C + 10 / DI,B - 40 / DI TO C + 10 / DI,B - 35 / DI
1110 HPLOT C - 10 / DI,B - 40 / DI TO C,B - 45 / DI TO C + 10 / DI,B - 4 0 / DI
1120 HPLOT C - 5 / DI,B - 40 / DI TO C + 5 / DI,B - 40 / DI TO C + 15 / DI,B - 30 / DI TO C,B - 40 / DI TO C - 15 / DI,B - 30 / DI TO C - 5 / DI + .5,B - 40 / DI
1130 GOTO 1480
1140 HPLOT C - 20 / DI,79 - YY%(DIS) TO C - 20 / DI,B - 88 / DI TO C - 1 0 / DI,B - 83 / DI TO C + 10 / DI,B - 83 / DI TO C + 20 / DI,B - 88 / DI TO C + 20 / DI,79 - YY%(DIS) TO C - 20 / DI,79 - YY%(DI)
1150 HPLOT C - 20 / DI,B - 88 / DI TO C - 30 / DI,B - 83 / DI TO C - 30 / DI,B - 78 / DI: HPLOT C + 20 / DI,B - 88 / DI TO C + 30 / DI,B - 83 / DI TO C + 40 / DI,B - 83 / DI
1160 HPLOT C - 15 / DI,B - 86 / DI TO C - 20 / DI,B - 83 / DI TO C - 20 / DI,B - 78 / DI TO C - 30 / DI,B - 73 / DI TO C - 30 / DI,B - 68 / DI TO C - 20 / DI,B - 63 / DI
1170 HPLOT C - 10 / DI,B - 83 / DI TO C - 10 / DI,B - 58 / DI TO C,B - 5 0 / DI: HPLOT C + 10 / DI,B - 83 / DI TO C + 10 / DI,B - 78 / DI TO C + 20 / DI,B - 73 / DI TO C + 20 / DI,B - 40 / DI
1180 HPLOT C + 15 / DI,B - 85 / DI TO C + 20 / DI,B - 78 / DI TO C + 30 / DI,B - 76 / DI TO C + 30 / DI,B - 60 / DI
1190 HPLOT C,B - 83 / DI TO C,B - 73 / DI TO C + 10 / DI,B - 68 / DI TO C + 10 / DI,B - 63 / DI TO C,B - 58 / DI
1200 GOTO 1480
1210 HPLOT C + 5 / DI + .5,B - 10 / DI TO C - 5 / DI + .5,B - 10 / DI TO C,B - 15 / DI TO C + 10 / DI,B - 20 / DI TO C + 5 / DI + .5,B - 15 / DI TO C + 5 / DI + .5,B - 10 / DI
1220 HPLOT TO C + 7 / DI + .5,B - 6 / DI TO C + 5 / DI + .5,B - 3 / DI TO C - 5 / DI + .5,B - 3 / DI TO C - 7 / DI + .5,B - 6 / DI TO C - 5 / DI + .5,B - 10 / DI
1230 HPLOT C + 2 / DI + .5,B - 3 / DI TO C + 5 / DI + .5,B TO C + 8 / DI ,B: HPLOT C - 2 / DI + .5,B - 3 / DI TO C - 5 / DI + .5,B TO C - 8 / DI,B: HPLOT C + 3 / DI + .5,B - 8 / DI
1235 HPLOT C - 3 / DI + .5,B - 8 / DI: HPLOT C + 3 / DI + .5,B - 5 / DI TO C - 3 / DI + .5,B - 5 / DI
1240 GOTO 1480
1250 HPLOT 139 - 10 / DIS,PER%(DIS,3) TO 139 - 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 10 / DIS,PE R%(DIS,3) TO 139 - 10 / DIS,PER%(DIS,3)
1260 HPLOT 139 - 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 - 5 / DIS,PER%(D IS,3) - 15 / DIS TO 139 + 15 / DIS,PER%(DIS,3) - 15 / DIS TO 139 + 1 5 / DIS,PER%(DIS,3) - 5 / DIS TO 139 + 10 / DIS,PER%(DIS,3)
1270 HPLOT 139 + 10 / DIS,PER%(DIS,3) - 10 / DIS TO 139 + 15 / DIS,PER%( DIS,3) - 15 / DIS
1280 GOTO 1480
1290 HPLOT C - 14 / DI,B - 46 / DI TO C - 12 / DI,B - 37 / DI TO C - 20 / DI,B - 32 / DI TO C - 30 / DI,B - 32 / DI
1295 HPLOT TO C - 22 / DI,B - 24 / DI TO C - 40 / DI,B - 17 / DI TO C - 40 / DI,B - 7 / DI TO C - 38 / DI ,B - 5 / DI TO C - 40 / DI,B - 3 / DI TO C - 40 / DI,B
1300 HPLOT TO C - 36 / DI,B TO C - 34 / DI,B - 2 / DI TO C - 32 / DI,B TO C - 28 / DI,B TO C - 28 / DI,B - 3 / DI TO C - 30 / DI,B - 5 / DI TO C - 28 / DI,B - 7 / DI TO C - 28 / DI,B - 15 / DI TO C,B - 27 / DI
1310 HPLOT C + 14 / DI,B - 46 / DI TO C + 12 / DI,B - 37 / DI TO C + 20 / DI,B - 32 / DI TO C + 30 / DI,B - 32 / DI
1315 HPLOT TO C + 22 / DI,B - 24 / DI TO C + 40 / DI,B - 17 / DI TO C + 40 / DI,B - 7 / DI TO C + 38 / DI ,B - 5 / DI TO C + 40 / DI,B - 3 / DI TO C + 40 / DI,B
1320 HPLOT TO C + 36 / DI,B TO C + 34 / DI,B - 2 / DI TO C + 32 / DI,B TO C + 28 / DI,B TO C + 28 / DI,B - 3 / DI TO C + 30 / DI,B - 5 / DI TO C + 28 / DI,B - 7 / DI TO C + 28 / DI,B - 15 / DI TO C,B - 27 / DI
1330 HPLOT C + 6 / DI,B - 48 / DI TO C + 38 / DI,B - 41 / DI TO C + 40 / DI,B - 42 / DI TO C + 18 / DI,B - 56 / DI
1335 HPLOT TO C + 12 / DI,B - 56 / DI TO C + 10 / DI,B - 57 / DI TO C + 8 / DI,B - 56 / DI TO C - 8 / DI, B - 56 / DI TO C - 10 / DI,B - 58 / DI TO C + 14 / DI,B - 58 / DI TO C + 16 / DI,B - 59 / DI
1340 HPLOT TO C + 8 / DI,B - 63 / DI TO C + 6 / DI,B - 63 / DI TO C + 2 / DI + .5,B - 70 / DI TO C + 2 / DI + .5,B - 63 / DI
1345 HPLOT TO C - 2 / DI + .5,B - 63 / DI TO C - 2 / DI + .5,B - 70 / DI TO C - 6 / DI,B - 63 / DI TO C - 8 / DI,B - 63 / DI TO C - 16 / DI,B - 59 / DI TO C - 14 / DI,B - 58 / DI
1350 HPLOT TO C - 10 / DI,B - 57 / DI TO C - 12 / DI,B - 56 / DI TO C - 18 / DI,B - 56 / DI TO C - 36 / DI,B - 47 / DI
1355 HPLOT TO C - 36 / DI,B - 39 / DI TO C - 28 / DI,B - 41 / DI TO C - 28 / DI,B - 46 / DI TO C - 2 0 / DI,B - 50 / DI TO C - 18 / DI,B - 50 / DI TO C - 14 / DI,B - 46 / DI
1360 GOTO 2790
1370 HPLOT C + 6 / DI,B - 60 / DI TO C + 30 / DI,B - 90 / DI TO C + 60 / DI,B - 30 / DI TO C + 60 / DI,B - 10 / DI TO C + 30 / DI,B - 40 / DI TO C + 15 / DI,B - 40 / DI
1380 HPLOT C - 6 / DI,B - 60 / DI TO C - 30 / DI,B - 90 / DI TO C - 60 / DI,B - 30 / DI TO C - 60 / DI,B - 10 / DI TO C - 30 / DI,B - 40 / DI TO C - 15 / DI,B - 40 / DI
1390 HPLOT C,B - 25 / DI TO C + 6 / DI,B - 25 / DI TO C + 10 / DI,B - 20 / DI TO C + 12 / DI,B - 10 / DI TO C + 10 / DI,B - 6 / DI TO C + 10 / DI,B TO C + 14 / DI,B TO C + 15 / DI,B - 5 / DI TO C + 16 / DI,B TO C + 20 / DI,B
1400 HPLOT TO C + 20 / DI,B - 6 / DI TO C + 18 / DI,B - 10 / DI TO C + 18 / DI,B - 20 / DI TO C + 15 / DI,B - 30 / DI TO C + 15 / DI,B - 45 / DI TO C + 40 / DI,B - 60 / DI TO C + 40 / DI,B - 70 / DI
1410 HPLOT TO C + 10 / DI,B - 55 / DI TO C + 6 / DI,B - 60 / DI TO C + 10 / DI,B - 74 / DI TO C + 6 / DI,B - 80 / DI TO C + 4 / DI + .5,B - 80 / DI TO C + 3 / DI + .5,B - 82 / DI TO C + 2 / DI + .5,B - 80 / D I TO C,B - 80 / DI
1420 HPLOT C,B - 25 / DI TO C - 6 / DI,B - 25 / DI TO C - 10 / DI,B - 20 / DI TO C - 12 / DI,B - 10 / DI TO C - 10 / DI,B - 6 / DI TO C - 10 / DI,B TO C - 14 / DI,B TO C - 15 / DI,B - 5 / DI TO C - 16 / DI,B TO C - 20 / DI,B
1430 HPLOT TO C - 20 / DI,B - 6 / DI TO C - 18 / DI,B - 10 / DI TO C - 18 / DI,B - 20 / DI TO C - 15 / DI,B - 30 / DI TO C - 15 / DI,B - 45 / DI TO C - 40 / DI,B - 60 / DI TO C - 40 / DI,B - 70 / DI
1440 HPLOT TO C - 10 / DI,B - 55 / DI TO C - 6 / DI,B - 60 / DI TO C - 10 / DI,B - 74 / DI TO C - 6 / DI,B - 80 / DI TO C - 4 / DI + .5,B - 80 / DI TO C - 3 / DI + .5,B - 82 / DI TO C - 2 / DI + .5,B - 80 / D I TO C,B - 80 / DI
1450 HPLOT C - 6 / DI,B - 25 / DI TO C,B - 6 / DI TO C + 10 / DI,B TO C + 4 / DI + .5,B - 8 / DI TO C + 6 / DI,B - 25 / DI: HPLOT C - 40 / DI, B - 64 / DI TO C - 40 / DI,B - 90 / DI TO C - 52 / DI,B - 80 / DI TO C - 52 / DI,B - 40 / DI
1460 HPLOT C + 40 / DI,B - 86 / DI TO C + 38 / DI,B - 92 / DI TO C + 42 / DI,B - 92 / DI TO C + 40 / DI,B - 86 / DI TO C + 40 / DI,B - 50 / DI
1470 HPLOT C + 4 / DI + .5,B - 70 / DI TO C + 6 / DI,B - 74 / DI: HPLOT C - 4 / DI + .5,B - 70 / DI TO C - 6 / DI,B - 74 / DI: HPLOT C,B - 6 4 / DI TO C,B - 60 / DI: GOTO 1480
1480 IF EN = 1 THEN EN = 0: RETURN
1490 DIS = DIS + 1: GOTO 460
1500 ZZ = RND ( - ABS (LN) - TX * 10 - TY * 1000 + INOUT * 31.4)
1510 FOR X = 1 TO 9: FOR Y = 1 TO 9:DNG%(X,Y) = 0: NEXT : NEXT
1520 FOR X = 0 TO 10:DNG%(X,0) = 1:DNG%(X,10) = 1:DNG%(0,X) = 1:DNG%(10, X) = 1: NEXT
1530 FOR X = 2 TO 8 STEP 2: FOR Y = 1 TO 9:DNG%(X,Y) = 1:DNG(Y,X) = 1: NEXT : NEXT
1540 FOR X = 2 TO 8 STEP 2: FOR Y = 1 TO 9 STEP 2
1550 IF RND (1) > .95 THEN DNG%(X,Y) = 2
1560 IF RND (1) > .95 THEN DNG%(Y,X) = 2
1570 IF RND (1) > .6 THEN DNG%(Y,X) = 3
1580 IF RND (1) > .6 THEN DNG%(X,Y) = 3
1590 IF RND (1) > .6 THEN DNG%(X,Y) = 4
1600 IF RND (1) > .6 THEN DNG%(Y,X) = 4
1610 IF RND (1) > .97 THEN DNG%(Y,X) = 9
1620 IF RND (1) > .97 THEN DNG%(X,Y) = 9
1630 IF RND (1) > .94 THEN DNG%(X,Y) = 5
1640 IF RND (1) > .94 THEN DNG%(Y,X) = 5
1650 NEXT : NEXT
1660 DNG%(2,1) = 0: IF INOUT / 2 = INT (INOUT / 2) THEN DNG%(7,3) = 7:DN G%(3,7) = 8
1670 IF INOUT / 2 < > INT (INOUT / 2) THEN DNG%(7,3) = 8:DNG%(3,7) = 7
1680 IF INOUT = 1 THEN DNG%(1,1) = 8:DNG%(7,3) = 0
1690 GOSUB 2680
1700 RETURN
1710 VTAB (24): PRINT "COMMAND? ";: CALL - 868
1720 X = PEEK ( - 16384): IF X < 128 THEN 1720
1730 Q = FRE (0)
1740 POKE - 16368,0
1750 IF X = 141 THEN ON SGN (INOUT) + 1 GOTO 1940,1960
1760 IF X = 149 THEN ON SGN (INOUT) + 1 GOTO 2030,2050
1770 IF X = 136 THEN ON SGN (INOUT) + 1 GOTO 2080,2100
1780 IF X = 175 THEN ON SGN (INOUT) + 1 GOTO 2130,2150
1790 IF X = 216 THEN ON SGN (INOUT) + 1 GOTO 2160,2200
1800 IF X = 193 OR X = 155 THEN ON SGN (INOUT) + 1 GOTO 2290,2300
1810 IF X = 160 THEN PRINT "PASS": GOTO 1860
1820 IF X = 211 THEN 2670
1830 IF X = 208 THEN IF PA = 1 THEN PA = 0: PRINT "PAUSE OFF": GOTO 1710
1840 IF X = 208 THEN IF PA = 0 THEN PA = 1: PRINT "PAUSE ON": GOTO 1710
1850 PRINT "HUH?": GOTO 1710
1860 PW(0) = PW(0) - 1 + SGN (INOUT) * .9: IF PW(0) < 0 THEN C(0) = 0: PRINT : PRINT "YOU HAVE STARVED!!!!!": GOTO 1890
1870 POKE 33,40: VTAB (22): HTAB (30): PRINT "FOOD=";PW(0);: CALL - 86 8: VTAB (23): HTAB (30): PRINT "H.P.=";C(0);: CALL - 868: VTAB (24) : HTAB (30): PRINT "GOLD=";C(5);: CALL - 868: POKE 33,29: HTAB (1)
1880 PW(0) = INT (PW(0) * 10) / 10
1890 IF C(0) < = 0 THEN 3130
1900 IF IN > 0 THEN GOSUB 2820: IF C(0) < = 0 THEN 1890
1910 POKE 33,40: VTAB (22): HTAB (30): PRINT "FOOD=";PW(0);: CALL - 86 8: VTAB (23): HTAB (30): PRINT "H.P.=";C(0);: CALL - 868: VTAB (24) : HTAB (30): PRINT "GOLD=";C(5);: CALL - 868: POKE 33,29: HTAB (1)
1920 IF INOUT = 0 THEN GOSUB 310: GOTO 1710
1930 IF INOUT > 0 THEN GOSUB 450: GOTO 1710
1940 PRINT "NORTH": IF TER%(TX,TY - 1) = 1 THEN PRINT "YOU CAN'T PASS THE MOUNTAINS": GOTO 1860
1950 TY = TY - 1: GOTO 1860
1960 IF DNG%(PX + DX,PY + DY) < > 1 AND DNG%(PX + DX,PY + DY) < 10 THEN PX = PX + DX:PY = PY + DY
1970 PRINT "FORWARD"
1980 IF DNG%(PX,PY) = 2 THEN PRINT "AAARRRGGGHHH!!! A TRAP!":C(0)= C( 0) - INT ( RND (1) * INOUT + 3):MR = 1:INOUT = INOUT + 1: PRINT "FA LLING TO LEVEL ";IN: GOSUB 1500: GOTO 1860
1990 Z = 0
2000 IF DNG%(PX,PY) = 5 THEN DNG%(PX,PY) = 0: PRINT "GOLD!!!!!":Z = INT ( RND (1) * 5 * INOUT + INOUT): PRINT Z;"-PIECES OF EIGHT":C(5) = C( 5) + Z
2010 IF Z > 0 THEN Z = INT ( RND (1) * 6): PRINT "AND A ";W$(Z):PW(Z) = PW(Z) + 1: GOTO 1860
2020 GOTO 1860
2030 PRINT "EAST": IF TER%(TX + 1,TY) = 1 THEN PRINT "YOU CAN'T PASS T HE MOUNTAINS": GOTO 1860
2040 TX = TX + 1: GOTO 1860
2050 PRINT "TURN RIGHT"
2060 IF DX < > 0 THEN DY = DX:DX = 0: GOTO 1860
2070 DX = - DY:DY = 0: GOTO 1860
2080 PRINT "WEST": IF TER%(TX - 1,TY) = 1 THEN PRINT "YOU CAN'T PASS T HE MOUNTAINS": GOTO 1860
2090 TX = TX - 1: GOTO 1860
2100 PRINT "TURN LEFT"
2110 IF DX < > 0 THEN DY = - DX:DX = 0: GOTO 1860
2120 DX = DY:DY = 0: GOTO 1860
2130 PRINT "SOUTH": IF TER%(TX,TY + 1) = 1 THEN PRINT "YOU CAN'T PASS THE MOUNTAINS": GOTO 1860
2140 TY = TY + 1: GOTO 1860
2150 PRINT "TURN AROUND":DX = - DX:DY = - DY: GOTO 1860
2160 IF TE%(TX,TY) = 3 THEN GOSUB 3610: GOSUB 3700: GOTO 1860
2170 IF TE%(TX,TY) = 4 AND INOUT = 0 THEN PRINT "GO DUNGEON": PRINT "P LEASE WAIT ":INOUT = 1: GOSUB 1500:DX = 1:DY = 0:PX = 1:PY = 1: GOTO 1860
2180 IF TE%(TX,TY) = 5 THEN 3220
2190 PRINT "HUH?": GOTO 1710
2200 IF DNG%(PX,PY) < > 7 AND DNG%(PX,PY) < > 9 THEN 2230
2210 PRINT "GO DOWN TO LEVEL ";INOUT + 1
2220 INOUT = INOUT + 1: GOSUB 1500:MR = 1: GOTO 1860
2230 IF DNG%(PX,PY) < > 8 THEN PRINT "HUH?": GOTO 1860
2240 IF IN = 1 THEN PRINT "LEAVE DUNGEON":IN = 0: GOTO 2270
2250 PRINT "GO UP TO LEVEL ";INOUT - 1
2260 INOUT = INOUT - 1: GOSUB 1500:MR = 1
2270 IF IN = 0 THEN PRINT "THOU HAST GAINED": PRINT LK;" HIT POINTS":C (0) = C(0) + LK:LK = 0
2280 GOTO 1860
2290 GOTO 1860
2300 MN = 0:DAM = 0: PRINT "ATTACK": PRINT "WHICH WEAPON ";: GET Q$
2310 IF Q$ = "R" THEN DAM = 10: PRINT "RAPIER": IF PW(1) < 1 THEN PRINT "NOT OWNED": GOTO 2300
2320 IF Q$ = "A" THEN DAM = 5: PRINT "AXE": IF PW(2) < 1 THEN PRINT "N OT OWNED": GOTO 2300
2330 IF Q$ = "S" THEN DAM = 1: PRINT "SHIELD": IF PW(3) < 1 THEN PRINT "NOT OWNED": GOTO 2300
2340 IF Q$ = "B" THEN DAM = 4: PRINT "BOW": IF PW(4) < 1 THEN PRINT "N OT OWNED": GOTO 2300
2350 IF Q$ = "M" THEN PRINT "MAGIC AMULET": GOTO 2540
2360 IF Q$ = "B" AND PT$ = "M" THEN PRINT "MAGES CAN'T USE BOWS!": GOTO 2300
2370 IF Q$ = "R" AND PT$ = "M" THEN PRINT "MAGES CAN'T USE RAPIERS!": GOTO 2300
2380 IF DAM = 0 THEN PRINT "HANDS"
2390 IF DAM = 5 OR DAM = 4 THEN 2490
2400 MN = DN%(PX + DX,PY + DY) / 10:MN = INT (MN)
2410 IF MN < 1 OR C(2) - RND (1) * 25 < MN + INOUT THEN PRINT "YOU MI SSED": GOTO 2470
2420 PRINT "HIT!!! "
2425 DAM ( RND (1) * DAM + C(1) / 5)
2426 MZ%(MN,1) = MZ%( MN,1) - DAM
2430 PRINT M$(MN);"'S HIT POINTS=";MZ%(MN,1)
2440 IF MZ%(MN,1) < 1 THEN PRINT "THOU HAST KILLED A ";M$(MN): PRINT " THOU SHALT RECEIVE":DA = INT (MN + IN): PRINT DA;" PIECES OF EIGHT"
2450 IF MZ%(MN,1) < 1 THEN C(5) = INT (C(5) + DA):DNG%(ML%(MN,0),ML%(M N,1)) = DNG%(ML%(MN,0),ML%(MN,1)) - 10 * MN:MZ%(MN,0) = 0
2460 LK = LK + INT (MN * IN / 2): IF MN = TASK THEN TASK = - TASK
2470 IF PA = 1 THEN PRINT "-CR- TO CONT. ";: INPUT Q$
2480 GOTO 1860
2490 IF DAM = 5 THEN PRINT "TO THROW OR SWING:";: GET Q$: IF Q$ < > " T" THEN PRINT "SWING": GOTO 2400
2500 IF DAM = 5 THEN PRINT "THROW":PW(2) = PW(2) - 1
2510 FOR Y = 1 TO 5: IF PX + DX * Y < 1 OR PX + DX * Y > 9 OR PY + DY * Y > 9 OR PY + DY * Y < 0 THEN 2410
2520 MN = DNG%(PX + DX * Y,PY + DY * Y):MN = INT (MN / 10): IF MN > 0 THEN 2410
2530 NEXT : GOTO 2410
2540 IF PW(5) < 1 THEN PRINT "NONE OWNED": GOTO 2300
2550 IF PT$ = "F" THEN Q = INT ( RND (1) * 4 + 1): GOTO 2580
2560 PRINT "1-LADDER-UP","2-LADDER-DN": PRINT "3-KILL","4-BAD??": PRINT "CHOICE ";: GET Q$:Q = VAL (Q$): PRINT Q: IF Q < 1 OR Q > 4 THEN 2560
2570 IF RND (1) > .75 THEN PRINT "LAST CHARGE ON THIS AMULET!":PW(5) = PW(5) - 1
2580 ON Q GOTO 2590,2600,2610,2620
2590 PRINT "LADDER UP":DNG%(PX,PY) = 8: GOTO 1860
2600 PRINT "LADDER DOWN":DNG%(PX,PY) = 7: GOTO 1860
2610 PRINT "MAGIC ATTACK":DAM = 10 + INOUT: GOTO 2510
2620 ON INT ( RND (1) * 3 + 1) GOTO 2630,2650,2660
2630 PRINT "YOU HAVE BEEN TURNED": PRINT "INTO A TOAD!"
2640 FOR Z2 = 1 TO 4:C(Z2) = 3: NEXT Z2: GOTO 1860
2650 PRINT "YOU HAVE BEEN TURNED": PRINT "INTO A LIZARD MAN": FOR Y = 0 TO 4:C(Y) = INT (C(Y) * 2.5): NEXT : GOTO 1860
2660 PRINT "BACKFIRE":C(0) = C(0) / 2: GOTO 1860
2670 GOSUB 3610: HOME : PRINT "PRESS -CR- TO CONTINUE";: INPUT Q$: TEXT : HOME : GOTO 1860
2680 NM = 0: FOR X = 1 TO 10
2690 MZ%(X,0) = 0:MZ%(X,1) = X + 3 + INOUT
2700 IF X - 2 > INO OR RND (1) > .4 THEN 2780
2710 ML%(X,0) = INT ( RND (1) * 9 + 1):ML%(X,1) = INT ( RND (1) * 9 + 1)
2720 IF DNG%(ML%(X,0),ML%(X,1)) < > 0 THEN 2710
2730 IF ML%(X,0) = PX AND ML%(X,1) = PY THEN 2710
2740 DNG%(ML%(X,0),ML%(X,1)) = X * 10
2750 MZ%(X,0) = 1
2760 NM = NM + 1
2770 MZ%(X,1) = X * 2 + IN * 2 * LP
2780 NEXT : RETURN
2790 HPLOT C - 28 / DI,B - 41 / DI TO C + 30 / DI,B - 55 / DI: HPLOT C + 28 / DI,B - 58 / DI TO C + 22 / DI,B - 56 / DI
2795 HPLOT TO C + 22 / DI,B - 53 / DI TO C + 28 / DI,B - 52 / DI TO C + 34 / DI,B - 54 / DI: HPLOT C + 20 / DI,B - 50 / DI TO C + 26 / DI,B - 47 / DI
2800 HPLOT C + 10 / DI,B - 58 / DI TO C + 10 / DI,B - 61 / DI TO C + 4 / DI,B - 58 / DI: HPLOT C - 10 / DI,B - 58 / DI TO C - 10 / DI,B - 61 / DI
2805 HPLOT TO C - 4 / DI,B - 58 / DI: HPLOT C + 40 / DI,B - 9 / DI TO C + 50 / DI,B - 12 / DI TO C + 40 / DI,B - 7 / DI
2810 HPLOT C - 8 / DI,B - 25 / DI TO C + 6 / DI,B - 7 / DI TO C + 28 / DI,B - 7 / DI TO C + 28 / DI,B - 9 / DI TO C + 20 / DI,B - 9 / DI TO C + 6 / DI,B - 25 / DI: GOTO 1480
2820 FOR MM = 1 TO 10: IF MZ%(MM,0) = 0 THEN 3120
2830 RA = SQR ((PX - ML%(MM,0)) ^ 2 + (PY - ML%(MM,1)) ^ 2)
2840 IF MZ%(MM,1) < IN * LP THEN 2870
2850 IF RA < 1.3 THEN 3020
2860 IF MM = 8 AND RA < 3 THEN 3120
2870 X1 = SGN (PX - ML%(MM,0)):Y1 = SGN (PY - ML%(MM,1))
2880 IF MZ%(MM,1) < IN * LP THEN X1 = - X1:Y1 = - Y1
2890 IF Y1 = 0 THEN 2920
2900 D = DNG%(ML%(MM,0),(ML%(MM,1) + Y1 + .5)): IF D = 1 OR D > 9 OR D = 2 THEN 2920
2910 X1 = 0: GOTO 2940
2920 Y1 = 0: IF X1 = 0 THEN 2940
2930 D = DN%((ML%(MM,0) + X1 + .5),ML%(MM,1)): IF D = 1 OR D > 9 OR D = 2 THEN X1 = 0: GOTO 2980
2940 DNG%(ML%(MM,0),ML%(MM,1)) = DNG%(ML%(MM,0),ML%(MM,1)) - 10 * MM
2950 IF ML%(MM,0) + X1 = PX AND ML%(MM,1) + Y1 = PY THEN 3120
2960 ML%(MM,0) = ML%(MM,0) + X1:ML%(MM,1) = ML%(MM,1) + Y1
2970 DNG%(ML%(MM,0),ML%(MM,1)) = (DNG%(ML%(MM,0),ML%(MM,1)) + 10 * MM + .5)
2980 IF X1 < > 0 OR Y1 < > 0 THEN 3120
2990 IF MZ%(MM,1) < IN * LP AND RA < 1.3 THEN 3020
3000 IF MZ%(MM,1) < IN * LP THEN MZ%(MM,1) = MZ%(MM,1) + MM + IN
3010 GOTO 3120
3020 IF MM = 2 OR MM = 7 THEN 3080
3030 PRINT "YOU ARE BEING ATTACKED": PRINT "BY A ";M$(MM)
3040 IF RND (1) * 20 - SGN (PW(3)) - C(3) + MM + IN < 0 THEN PRINT " MISSED": GOTO 3060
3050 PRINT "HIT":C(0) = C(0) - INT ( RND (1) * MM + IN)
3060 IF PA = 1 THEN PRINT "-CR- TO CONT. ";: INPUT Q$
3070 GOTO 3120
3080 IF RND (1) < .5 THEN 3030
3090 IF MM = 7 THEN PW(0) = INT (PW(0) / 2): PRINT "A GREMLIN STOLE SO ME FOOD": GOTO 3060
3100 ZZ = INT ( RND (1) * 6): IF PW(ZZ) < 1 THEN 3100
3110 PRINT "A THIEF STOLE A ";W$(ZZ):PW(ZZ) = PW(ZZ) - 1: GOTO 3060
3120 NEXT : RETURN
3130 POKE 33,40: PRINT : PRINT : PRINT "    WE MOURN THE PASSING OF "
3140 IF LEN (PN$) > 22 THEN PN$ = ""
3150 IF PN$ = "" THEN PN$ = "THE PEASANT"
3160 PN$ = PN$ + " AND HIS COMPUTER"
3170 HTAB (20 - INT ( LEN (PN$) / 2)): PRINT PN$
3180 PRINT " TO INVOKE A MIRACLE OF RESSURECTION"
3190 PRINT "       <HIT ESC KEY>";
3200 IF PEEK ( - 16384) = 155 THEN 10
3210 GOTO 3200
3220 HOME : TEXT : HOME
3230 CALL 62450
3240 IF PN$ < > "" THEN 3320
3250 PRINT : PRINT : PRINT "   WELCOME PEASANT INTO THE HALLS OF": PRINT "THE MIGHTY LORD BRITISH. HEREIN THOU MAYCHOOSE TO DARE BATTLE WITH THE EVIL": PRINT "CREATURES OF THE DEPTHS, FOR GREAT": PRINT "REWARD !"
3260 PRINT : PRINT "WHAT IS THY NAME PEASANT ";: INPUT PN$
3270 PRINT "DOEST THOU WISH FOR GRAND ADVENTURE ? ";: GET Q$: IF Q$ < > "Y" THEN PRINT : PRINT "THEN LEAVE AND BEGONE!":PN$ = "": PRINT : PRINT "     PRESS -SPACE- TO CONT.";: GET Q$: GOTO 1860
3280 PRINT
3290 PRINT : PRINT "GOOD! THOU SHALT TRY TO BECOME A ": PRINT "KNIGHT!! !": PRINT : PRINT "THY FIRST TASK IS TO GO INTO THE": PRINT "DUNGEON S AND TO RETURN ONLY AFTER": PRINT "KILLING A(N) ";:TASK = INT (C(4 ) / 3): PRINT M$(TASK)
3300 PRINT : PRINT "   GO NOW UPON THIS QUEST, AND MAY": PRINT "LADY LUCK BE FAIR UNTO YOU.....": PRINT ".....ALSO I, BRITISH, HAVE INCRE ASED": PRINT "EACH OF THY ATTRIBUTES BY ONE!"
3310 PRINT : PRINT "     PRESS -SPACE- TO CONT.";: GET Q$: FOR X = 0 TO 5:C(X) = C(X) + 1: NEXT : HOME : GOTO 1860
3320 IF TASK > 0 THEN PRINT : PRINT : PRINT PN$;" WHY HAST THOU RETURN ED?": PRINT "THOU MUST KILL A(N) ";M$(TASK): PRINT "GO NOW AND COMPL ETE THY QUEST!": PRINT : PRINT "     PRESS -SPACE- TO CONT.";: GET Q$: HOME : GOTO 1860
3330 PRINT : PRINT : PRINT : PRINT "AAHH!!.....";PN$: PRINT : PRINT "TH OU HAST ACOMPLISHED THY QUEST!": IF ABS (TASK) = 10 THEN 3360
3340 PRINT "UNFORTUNATELY, THIS IS NOT ENOUGH TO": PRINT "BECOME A KNIG HT.":TASK = ABS (TASK) + 1: PRINT : PRINT "NOW THOU MUST KILL A(N) ";M$(TASK)
3350 GOTO 3300
3360 TEXT : HOME : PRINT : PRINT : PRINT :PN$ = "LORD " + PN$: PRINT "   ";PN$;","
3370 PRINT "    THOU HAST PROVED THYSELF WORTHY": PRINT "OF KNIGHTHO OD, CONTINUE PLAY IF THOU": PRINT "DOTH WISH, BUT THOU HAST ACOMPLIS HED": PRINT "THE MAIN OBJECTIVE OF THIS GAME..."
3380 IF LP = 10 THEN 3410
3390 PRINT : PRINT "  NOW MAYBE THOU ART FOOLHEARTY": PRINT "ENOUGH TO TRY DIFFICULTY LEVEL ";LP + 1
3400 GOTO 3310
3410 PRINT : PRINT "...CALL CALIFORNIA PACIFIC COMPUTER": PRINT "AT (41 5)-569-9126 TO REPORT THIS": PRINT "AMAZING FEAT!"
3420 GOTO 3310
3430 TEXT : HOME : VTAB (5): INPUT "TYPE THY LUCKY NUMBER.....";Q$:LN = VAL (Q$)
3440 VTAB (7): INPUT "LEVEL OF PLAY (1-10)......";Q$:LP = INT ( VAL ( Q$))
3450 IF LP < 1 OR LP > 10 THEN 3440
3460 ZZ = RND ( - ABS (LN))
3470 DATA  "HIT POINTS.....","STRENGTH.......","DEXTERITY......","STA MINA........","WISDOM.........","GOLD..........."
3480 DIM PW(5)
3490 DIM C$(5): FOR X = 0 TO 5: READ C$(X): NEXT
3500 DIM C(5)
3510 DIM M$(10),ML%(10,1),MZ%(10,1)
3520 DATA    "SKELETON","THIEF","GIANT RAT","ORC","VIPER","CARRION CRAWLER","GREMLIN","MIMIC","DAEMON","BALROG"
3530 FOR X = 1 TO 10: READ M$(X): NEXT
3540 FOR X = 0 TO 5:C(X) = INT ( SQR ( RND (1)) * 21 + 4): NEXT X
3550 HOME : VTAB (8): FOR X = 0 TO 5: PRINT C$(X),C(X): NEXT : PRINT : PRINT "SHALT THOU PLAY WITH THESE QUALITIES?": HTAB (20): GET Q$: IF Q$ < > "Y" THEN 3540
3560 VTAB (15): PRINT : PRINT "AND SHALT THOU BE A FIGHTER OR A MAGE?" : HTAB (20): GET PT$
3570 IF PT$ = "M" OR PT$ = "F" THEN 3590
3580 GOTO 3560
3590 DIM W$(5): DATA  "FOOD","RAPIER","AXE","SHIELD","BOW AND ARROWS ","MAGIC AMULET": FOR X = 0 TO 5: READ W$(X): NEXT
3600 GOSUB 3610: GOSUB 3700: RETURN
3610 TEXT : HOME : PRINT : PRINT : PRINT "   STAT'S       WEA PONS": PRINT : FOR X = 0 TO 5: PRINT C$(X);C(X); TAB( 24);"0-";W$(X) : NEXT : POKE 34,12: HOME : POKE 35,15
3620 VTAB (11): HTAB (18): PRINT "Q-QUIT"
3630 IF PW(0) > 0 THEN CALL 62450
3640 FOR Z = 0 TO 5: VTAB (5 + Z): HTAB (25 - LEN ( STR$ (PW(Z)))): PRINT PW(Z);: NEXT
3650 VTAB (17): HTAB (5): PRINT "PRICE";: HTAB (15): PRINT "DAMAGE";: HTAB (25): PRINT "ITEM"
3660 FOR X = 0 TO 5: VTAB (19 + X): HTAB (25): PRINT W$(X): NEXT
3670 VTAB (19): HTAB (5): PRINT "1 FOR 10": HTAB (15): PRINT "N/A": VTAB (20): HTAB (5): PRINT "8": HTAB (15): PRINT "1-10": VTAB (21): HTAB (5): PRINT "5": HTAB (15): PRINT "1-5"
3680 VTAB (22): HTAB (5): PRINT "6": HTAB (15): PRINT "1": VTAB (23): HTAB (5): PRINT "3": HTAB (15): PRINT "1-4": VTAB (24): HTAB (5): PRINT " 15": HTAB (15): PRINT "?????": HOME
3690 RETURN
3700 HOME : PRINT "WELCOME TO THE ADVENTURE SHOP"
3710 PRINT "WHICH ITEM SHALT THOU BUY ";: GET Q$: IF Q$ = "Q" THEN PRINT : PRINT "BYE": FOR Z = 1 TO 1000: NEXT : TEXT : HOME : RETURN
3720 Z = - 1
3730 IF Q$ = "F" THEN PRINT "FOOD":Z = 0:P = 1
3740 IF Q$ = "R" THEN PRINT "RAPIER":Z = 1:P = 8
3750 IF Q$ = "A" THEN PRINT "AXE":Z = 2:P = 5
3760 IF Q$ = "S" THEN PRINT "SHIELD":Z = 3:P = 6
3770 IF Q$ = "B" THEN PRINT "BOW":Z = 4:P = 3
3780 IF Q$ = "M" THEN PRINT "AMULET":Z = 5:P = 15
3790 IF Z = - 1 THEN PRINT Q$: PRINT "I'M SORRY WE DON'T HAVE THAT." : GOTO 3710
3800 IF Q$ = "R" AND PT$ = "M" THEN PRINT "I'M SORRY MAGES": PRINT "CAN'T USE THAT!": GOTO 3710
3810 IF Q$ = "B" AND PT$ = "M" THEN PRINT "I'M SORRY MAGES": PRINT "CAN'T USE THAT!": GOTO 3710
3820 IF C(5) - P < 0 THEN PRINT "M'LORD THOU CAN NOT AFFORD THAT ITEM.": GOTO 3710
3830 IF Z = 0 THEN PW(Z) = PW(Z) + 9
3840 PW(Z) = PW(Z) + 1:C(5) = C(5) - P
3850 VTAB (10): HTAB (16): PRINT C(5);" "
3860 VTAB (5 + Z): HTAB (25 - LEN ( STR$ (PW(Z)))): PRINT PW(Z);: HTAB (1): VTAB (14): PRINT
3870 GOTO 3710