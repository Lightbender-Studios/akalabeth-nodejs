0  ONERR GOTO 20
1  REM
2  PR# 0
3   IN# 0
4  HIMEM: 49151
6  REM ------------------ NEW GAME GOSUB ------------------
7  CLEAR
8  GOSUB 3750
9  REM ------------------ MAIN PROGRAM ------------------
10  ZZ = RND(-ABS(LN))
11  LE = 0
12  TEXT
13   HOME
14   NORMAL
15   VTAB (12)
16   PRINT " WELCOME TO AKALABETH, WORLD OF DOOM!"
17  DIM DN%(10,10),TE%(20,20),XX%(10),YY%(10),PE%(10,3),LD%(10,5),CD%(10,3),FT%(10,5),LA(10,3)
18  rem
19  REM ------------------ DRAW OVERLAND ------------------
20  FOR X = 0 TO 20
21     TE%(X,0) = 1
22     TE%(0,X) = 1
23     TE%(X,20) = 1
24   TE%(20,X) = 1
25  NEXT
26  rem
27   VTAB (23)
28   PRINT " (PLEASE WAIT)";
29  REM
30  FOR X = 1 TO 19
31   FOR Y = 1 TO 19
32    TE%(X,Y) = INT ( RND (1) ^ 5 * 4.5 )
33      IF TE%(X,Y) = 3 AND RND (1) > .5 THEN TE%(X,Y) = 0
34  NEXT
35   PRINT ".";
36   NEXT
37
38  TE%( INT ( RND (1) * 19 + 1), INT ( RND (1) * 19 + 1)) = 5
39  TX = INT ( RND (1) * 19 + 1)
40  TY = INT ( RND (1) * 19 + 1)
41  TE%(TX,TY) = 3
42
43  REM ------------------ DRAW ?? ------------------
44  XX%(0) = 139
45  YY%(0) = 79
46  FOR X = 2 TO 20 STEP 2
47  XX%(X / 2) = INT ( ATN (1 / X) / ATN (1) * 140 + .5)
48  YY%(X / 2) = INT (XX%(X / 2) * 4 / 7)
49  PE%(X / 2,0) = 139 - XX%(X / 2)
50  PE%(X / 2,1) = 139 + XX%(X / 2)
51  PE%(X / 2,2) = 79 - YY%(X / 2)
52  PE%(X / 2,3) = 79 + YY%(X / 2)
53   NEXT
54
55  PE%(0,0) = 0
56  PE%(0,1) = 279
57  PE%(0,2) = 0
58  PE%(0,3) = 159
59
60  FOR X = 1 TO 10
61  CD%(X,0) = 139 - XX%(X) / 3
62  CD%(X,1) = 139 + XX%(X) / 3
63  CD%(X,2) = 79 - YY%(X) * .7
64  CD%(X,3) = 79 + YY%(X)
65   NEXT
66   PRINT " .";
67
68  FOR X = 0 TO 9
69  LD%(X,0) = (PE%(X,0) * 2 + PE%(X + 1,0)) / 3
70
71  LD%(X, 1) = (PE%(X,0) + 2 * PE%(X + 1,0)) / 3
72  W = LD%(X,0) - PE%(X,0)
73  LD%(X,2) = PE%(X,2) + W * 4 / 7
74  LD%(X,3) = PE%(X,2) + 2 * W * 4 / 7
75   LD%(X,4) = (PE%(X,3) * 2 + PE%(X + 1,3)) / 3
76  LD%(X,5) = (PE%(X,3) + 2 * PE%(X + 1,3)) / 3
77  LD%(X,2) = LD%(X,4) - (LD%(X,4) - LD%(X,2)) * .8
78  LD%(X,3) = LD%(X,5) - (LD%(X,5) - LD%(X,3)) * .8
79   IF LD%(X,3) = LD%(X,4) THEN LD%(X,3) = LD%(X,3) - 1
80  NEXT
81  REM ---------------------------------------------
82
83  FOR X = 0 TO 9
84  FT%(X,0) = 139 - XX%(X) / 3
85  FT%(X,1) = 139 + XX%(X) / 3
86  FT%(X,2) = 139 - XX%(X + 1) / 3
87  FT%(X,3) = 139 + XX%(X + 1) / 3
88  FT%(X,4) = 79 + (YY%(X) * 2 + YY%(X + 1)) / 3
89  FT%(X,5) = 79 + (YY%(X) + 2 * YY%(X + 1)) / 3
90   NEXT
91
92  FOR X = 0 TO 9
93  LA(X,0) = (FT%(X,0) * 2 + FT%(X,1)) / 3
94  LA(X,1) = (FT%(X,0) + 2 * FT%(X,1)) / 3
95  LA(X,3) = FT%(X,4)
96  LA(X,2) = 159 - LA(X,3)
97   NEXT
98  REM ------------------ CLEAR SCREEN ------------------
99  HOME
100   HCOLOR= 3
101  POKE 34,20
102   POKE 33,29
103   HOME
104  GOSUB 470
105  GOTO 1930
106  FOR X = 0 TO 9
107   FOR Y = 0 TO 5
108   PRINT LD%(X,Y);" ";
109   NEXT
110   PRINT
111   NEXT
112   GET Q$
113  REM ------------------ HANDLE DUNGEON ------------------
114  HGR
115   FOR Y = - 1 TO 1
116   FOR X = - 1 TO 1
117  HPLOT 138,75 TO 142,75
118   HPLOT 140,73 TO 140,77
119  ZZ = TE%(TX + X,TY + Y)
120  X1 = 65 + (X + 1) * 50
121  Y1 = (Y + 1) * 50
122  IF ZZ = 2 THEN HPLOT X1 + 20,Y1 + 20 TO X1 + 30,Y1 + 20 TO X1 + 30 ,Y1 + 30 TO X1 + 20,Y1 + 30 TO X1 + 20,Y1 + 20
123  IF ZZ = 3 THEN HPLOT X1 + 10,Y1 + 10 TO X1 + 20,Y1 + 10 TO X1 + 20 ,Y1 + 40 TO X1 + 10,Y1 + 40 TO X1 + 10,Y1 + 30
124  IF ZZ = 3 THEN HPLOT X1 + 40,Y1 + 30 TO X1 + 40,Y1 + 40 TO X1 + 30,Y1 + 40 TO X1 + 30,Y1 + 10 TO X1 + 40,Y1 + 10
125  IF ZZ = 3 THEN HPLOT X1 + 40,Y1 + 20 TO X1 + 10,Y1 + 20 TO X1 + 10,Y1 + 10
126  IF ZZ = 4 THEN HPLOT X1 + 20,Y1 + 20 TO X1 + 30,Y1 + 30
127   HPLOT X1 + 20,Y1 + 30 TO X1 + 30,Y1 + 20
128  IF ZZ = 5 THEN HPLOT X1,Y1 TO X1 + 50,Y1 TO X1 + 50,Y1 + 50 TO X1, Y1 + 50 TO X1,Y1560
129   HPLOT X1 + 10,Y1 + 10 TO X1 + 10,Y1 + 40 TO X1 + 40,Y1 + 40 TO X1 + 40,Y1 + 10 TO X1 + 10,Y1 + 10 TO X1 + 40,Y1 + 40
130   HPLOT X1 + 10,Y1 + 40 TO X1 + 40,Y1 + 10
131  IF ZZ = 1 THEN HPLOT X1 + 10,Y1 + 50 TO X1 + 10,Y1 + 40 TO X1 + 20 ,Y1 + 30 TO X1 + 40,Y1 + 30 TO X1 + 40,Y1 + 50
132  HPLOT X1,Y1 + 10 TO X1 + 10,Y1 + 10
133   HPLOT X1 + 50,Y1 + 10 TO X1 + 40,Y1 + 10
134   HPLOT X1, Y1 + 40 TO X1 + 10,Y1 + 40
135   HPLOT X1 + 40,Y1 + 40 TO X1 + 50,Y1 + 40
136  IF ZZ = 1 THEN HPLOT X1 + 10,Y1 TO X1 + 10,Y1 + 20 TO X1 + 20,Y1 + 20 TO X1 + 20,Y1 + 30 TO X1 + 30,Y1 + 30 TO X1 + 30,Y1 + 10 TO X1 + 40,Y1 + 10 TO X1 + 40,Y1
137  NEXT
138   NEXT
139   RETURN
140  HGR
141  DI = 0
142   HCOLOR= 3
143  CE = DN%(PX + DX * DI,PY + DY * DI)
144  LE = DN%(PX + DX * DI + DY,PY + DY * DI - DX)
145  RI = DN%(PX + DX * DI - DY,PY + DY * DI + DX)
146  L1 = PE%(DI,0)
147  R1 = PE%(DI,1)
148  T1 = PE%(DI,2)
149  B1 = PE%(DI,3)
150   L2 = PE%(DI + 1,0)
151  R2 = PE%(DI + 1,1)
152  T2 = PE%(DI + 1,2)
153  B2 = PE%(DI + 1,3)
154  CE = INT (CE)
155  LE = INT (LE)
156  RI = INT (RI)
157  MC = INT (CE / 10)
158  CE = CE - MC * 10
159  LE = INT ((LE / 10 - INT (LE / 10)) * 10 + .1)
160  RI = INT ((RI / 10 - INT (RI / 10 )) * 10 + .1)
161  IF DI = 0 THEN 700
162  IF CE = 1 OR CE = 3 OR CE = 4 THEN HPLOT L1,T1 TO R1,T1 TO R1,B1 TO L1,B1 TO L1,T1
163  IF CE = 1 OR CE = 3 THEN EN = 1
164   GOTO 900
165  IF CE = 4 THEN HPLOT CD%(DI,0),CD%(DI,3) TO CD%(DI,0),CD%(DI ,2) TO CD%(DI,1),CD%(DI,2) TO CD%(DI,1),CD%(DI,3)
166  EN = 1
167   GOTO 900
168  IF LE = 1 OR LE = 3 OR LE = 4 THEN HPLOT L1,T1 TO L2,T2
169   HPLOT L1,B1 TO L2,B2
170  IF RI = 1 OR RI = 3 OR RI = 4 THEN HPLOT R1,T1 TO R2,T2
171   HPLOT R1,B1 TO R2,B2
172  IF LE = 4 AND DI > 0 THEN HPLOT LD%(DI,0),LD%(DI,4) TO LD%(DI,0),LD%(DI,2) TO LD%(DI,1),LD%(DI,3) TO LD%(DI,1),LD%(DI,5)
173  IF LE = 4 AND DI = 0 THEN HPLOT 0,LD%(DI,2) - 3 TO LD%(DI,1), LD%(DI,3) TO LD%(DI,1),LD%(DI,5)
174  IF RI = 4 AND DI > 0 THEN HPLOT 279 - LD%(DI,0),LD%(DI,4) TO 279 - LD%(DI,0),LD%(DI,2) TO 279 - LD%(DI,1),LD%(DI,3) TO 279 - LD%(DI,1),LD%(DI,5)
175  IF RI = 4 AND DI = 0 THEN HPLOT 279,LD%(DI,2) - 3 TO 279 - LD% (DI,1),LD%(DI,3) TO 279 - LD%(DI,1),LD%(DI,5)
176  IF LE = 3 OR LE = 1 OR LE = 4 THEN 790
177  IF DI < > 0 THEN HPLOT L1,T1 TO L1,B1
178  HPLOT L1,T2 TO L2,T2 TO L2,B2 TO L1,B2
179  IF RI = 3 OR RI = 1 OR RI = 4 THEN 820
180  IF DI < > 0 THEN HPLOT R1,T1 TO R1,B1
181  HPLOT R1,T2 TO R2,T2 TO R2,B2 TO R1,B2
182  IF CE = 7 OR CE = 9 THEN HPLOT FT%(DI,0),FT%(DI,4) TO FT%(DI,2),FT%(DI,5) TO FT%(DI,3),FT%(DI,5) TO FT%(DI,1),FT%(DI,4) TO FT%(DI,0),FT%(DI,4)
183  IF CE = 8 THEN HPLOT FT%(DI,0),158 - FT%(DI,4) TO FT%(DI,2),158 - FT%(DI,5) TO FT%(DI,3),158 - FT%(DI,5) TO FT%(DI,1),158 - FT%(DI,4) TO FT%(DI,0),158 - FT%(DI,4)
184  IF CE = 7 OR CE = 8 THEN BA = LA(DI,3)
185  TP = LA(DI,2)
186  LX = LA(DI,0)
187  RX = LA(DI,1)
188   HPLOT LX,BA TO LX,TP
189   HPLOT RX,TP TO RX,BA
190  IF CE = 7 OR CE = 8 THEN Y1 = (BA * 4 + TP) / 5
191  Y2 = (BA * 3 + TP * 2) / 5
192  Y3 = (BA * 2 + TP * 3) / 5
193  Y4 = (BA + TP * 4) / 5
194   HPLOT LX,Y1 TO RX,Y1
195   HPLOT LX,Y2 TO RX,Y2
196   HPLOT LX,Y3 TO RX,Y3
197   HPLOT LX ,Y4 TO RX,Y4
198  IF DI > 0 AND CE = 5 THEN HPLOT 139 - 10 / DI,PE%(DI,3) TO 139 - 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 10 / DI,PE%(DI,3) TO 139 - 10 / DI,PE%(DI,3)
199  IF CE = 5 AND DI > 0 THEN INVERSE
200   PRINT "CHEST!"
201   NORMAL
202  IF DI > 0 AND CE = 5 THEN HPLOT 139 - 10 / DI,PE%(DI,3) - 10 / DI TO 139 - 5 / DI,PE%(DI,3) - 15 / DI TO 139 + 15 / DI,PE%(DI,3) - 15 / DI TO 139 + 15 / DI,PE%(DI,3) - 5 / DI TO 139 + 10 / DI,PE%(DI,3)
203  IF DI > 0 AND CE = 5 THEN HPLOT 139 + 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 15 / DI,PE%(DI,3) - 15 / DI
204  IF MC < 1 THEN 1700
205  B = 79 + YY%(DI)
206  C = 139
207  INVERSE
208   IF MC = 8 THEN PRINT "CHEST!";
209   CALL - 868
210   PRINT
211   NORMAL
212   GOTO 940
213  PRINT M$(MC);
214   CALL - 868
215   PRINT
216   NORMAL
217  IF DI = 0 THEN 1700
218  ON MC GOTO 970,1040,1080,1140,1220,1300,1370,1420,1460,1590
219  GOTO 1700
220  HPLOT C - 23 / DI,B TO C - 15 / DI,B TO C - 15 / DI,B - 15 / DI TO C - 8 / DI,B - 30 / DI TO C + 8 / DI,B - 30 / DI TO C + 15 / DI,B - 15 / DI TO C + 15 / DI,B TO C + 23 / DI,B
221  HPLOT C,B - 26 / DI TO C,B - 65 / DI
222   HPLOT C - 2 / DI + .5,B - 38 / DI TO C + 2 / DI + .5,B - 38 / DI
223   HPLOT C - 3 / DI + .5,B - 45 / DI TO C + 3 / DI + .5,B - 45 / DI
224   HPLOT C - 5 / DI + .5,B - 53 / DI TO C + 5 / DI + .5,B - 53 / DI
225  HPLOT C - 23 / DI,B - 56 / DI TO C - 30 / DI,B - 53 / DI TO C - 23 / DI,B - 45 / DI TO C - 23 / DI,B - 53 / DI TO C - 8 / DI,B - 38 / DI
226  HPLOT C - 15 / DI,B - 45 / DI TO C - 8 / DI,B - 60 / DI TO C + 8 / DI,B - 60 / DI TO C + 15 / DI,B - 45 / DI
227   HPLOT C + 15 / DI,B - 42 / DI TO C + 15 / DI,B - 57 / DI
228   HPLOT C + 12 / DI,B - 45 / DI TO C + 20 / DI,B - 45 / DI
229  HPLOT C,B - 75 / DI TO C - 5 / DI + .5,B - 80 / DI TO C - 8 / DI,B - 75 / DI TO C - 5 / DI + .5,B - 65 / DI TO C + 5 / DI + .5,B - 65 / DI TO C + 5 / DI + .5,B - 68 / DI TO C - 5 / DI + .5,B - 68 / DI TO C - 5 / DI + .5,B - 65 / DI
230  HPLOT TO C + 5 / DI + .5,B - 65 / DI TO C + 8 / DI,B - 75 / DI TO C + 5 / DI + .5,B - 80 / DI TO C - 5 / DI + .5,B - 80 / DI
231   HPLOT C - 5 / DI + .5,B - 72 / DI
232   HPLOT C + 5 / DI + .5,B - 72 / DI
233  GOTO 1700
234  HPLOT C,B - 56 / DI TO C,B - 8 / DI TO C + 10 / DI,B TO C + 30 / DI ,B TO C + 30 / DI,B - 45 / DI TO C + 10 / DI,B - 64 / DI TO C,B - 56 / DI
235  HPLOT TO C - 10 / DI,B - 64 / DI TO C - 30 / DI,B - 45 / DI TO C - 30 / DI,B TO C - 10 / DI,B TO C,B - 8 / DI
236  HPLOT C - 10 / DI,B - 64 / DI TO C - 10 / DI,B - 75 / DI TO C,B - 83 / DI TO C + 10 / DI,B - 75 / DI TO C,B - 79 / DI TO C - 10 / DI,B - 75 / DI TO C,B - 60 / DI TO C + 10 / DI,B - 75 / DI TO C + 10 / DI,B - 64 / DI
237  GOTO 1700
238  HPLOT C + 5 / DI,B - 30 / DI TO C,B - 25 / DI TO C - 5 / DI,B - 30 / DI TO C - 15 / DI,B - 5 / DI TO C - 10 / DI,B TO C + 10 / DI,B TO C + 15 / DI,B - 5 / DI
239  HPLOT TO C + 20 / DI,B - 5 / DI TO C + 10 / DI,B TO C + 15 / DI,B - 5 / DI TO C + 5 / DI,B - 30 / DI TO C + 10 / DI,B - 40 / DI TO C + 3 / DI + .5,B - 35 / DI
240  HPLOT TO C - 3 / DI + .5,B - 35 / DI TO C - 10 / DI ,B - 40 / DI TO C - 5 / DI,B - 30 / DI
241  HPLOT C - 5 / DI,B - 33 / DI TO C - 3 / DI + .5,B - 30 / DI
242   HPLOT C + 5 / DI,B - 33 / DI TO C + 3 / DI + .5,B - 30 / DI
243   HPLOT C - 5 / DI,B - 20 / DI TO C - 5 / DI,B - 15 / DI
244  HPLOT C + 5 / DI,B - 20 / DI TO C + 5 / DI,B - 15 / DI
245   HPLOT C - 7 / DI,B - 20 / DI TO C - 7 / DI,B - 15 / DI
246   HPLOT C + 7 / DI,B - 20 / DI TO C + 7 / DI,B - 15 / DI
247  GOTO 1700
248  HPLOT C,B TO C - 15 / DI,B TO C - 8 / DI,B - 8 / DI TO C - 8 / DI,B - 15 / DI TO C - 15 / DI,B - 23 / DI TO C - 15 / DI,B - 15 / DI TO C - 23 / DI,B - 23 / DI
249  HPLOT TO C - 23 / DI,B - 45 / DI TO C - 15 / DI,B - 53 / DI TO C - 8 / DI,B - 53 / DI TO C - 15 / DI,B - 68 / DI TO C - 8 / DI,B - 75 / DI TO C,B - 75 / DI
250  HPLOT C,B TO C + 15 / DI,B TO C + 8 / DI,B - 8 / DI TO C + 8 / DI,B - 15 / DI TO C + 15 / DI,B - 23 / DI TO C + 15 / DI,B - 15 / DI TO C + 23 / DI,B - 23 / DI
251  HPLOT TO C + 23 / DI,B - 45 / DI TO C + 15 / DI,B - 53 / DI TO C + 8 / DI,B - 53 / DI TO C + 15 / DI,B - 68 / DI TO C + 8 / DI,B - 75 / DI TO C,B - 75 / DI
252  HPLOT C - 15 / DI,B - 68 / DI TO C + 15 / DI,B - 68 / DI
253   HPLOT C - 8 / DI,B - 53 / DI TO C + 8 / DI,B - 53 / DI
254   HPLOT C - 23 / DI,B - 15 / DI TO C + 8 / DI,B - 45 / DI
255  HPLOT C - 8 / DI,B - 68 / DI TO C,B - 60 / DI TO C + 8 / DI,B - 68 / DI TO C + 8 / DI,B - 60 / DI TO C - 8 / DI,B - 60 / DI TO C - 8 / DI ,B - 68 / DI
256  HPLOT C,B - 38 / DI TO C - 8 / DI,B - 38 / DI TO C + 8 / DI,B - 53 / DI TO C + 8 / DI,B - 45 / DI TO C + 15 / DI,B - 45 / DI TO C,B - 30 / DI TO C,B - 38 / DI
257  GOTO 1700
258  HPLOT C - 10 / DI,B - 15 / DI TO C - 10 / DI,B - 30 / DI TO C - 15 / DI,B - 20 / DI TO C - 15 / DI,B - 15 / DI TO C - 15 / DI,B TO C + 15 / DI,B TO C + 15 / DI,B - 15 / DI TO C - 15 / DI,B - 15 / DI
259  HPLOT C - 15 / DI,B - 10 / DI TO C + 15 / DI,B - 10 / DI
260   HPLOT C - 15 / DI,B - 5 / DI TO C + 15 / DI,B - 5 / DI
261  HPLOT C,B - 15 / DI TO C - 5 / DI,B - 20 / DI TO C - 5 / DI,B - 35 / DI TO C + 5 / DI,B - 35 / DI TO C + 5 / DI,B - 20 / DI TO C + 10 / DI,B - 15 / DI
262  HPLOT C - 5 / DI,B - 20 / DI TO C + 5 / DI,B - 20 / DI
263   HPLOT C - 5 / DI,B - 25 / DI TO C + 5 / DI,B - 25 / DI
264   HPLOT C - 5 / DI,B - 30 / DI TO C + 5 / DI,B - 30 / DI
265  HPLOT C - 10 / DI,B - 35 / DI TO C - 10 / DI,B - 40 / DI TO C - 5 / DI,B - 45 / DI TO C + 5 / DI,B - 45 / DI TO C + 10 / DI,B - 40 / DI TO C + 10 / DI,B - 35 / DI
266  HPLOT C - 10 / DI,B - 40 / DI TO C,B - 45 / DI TO C + 10 / DI,B - 40 / DI
267  HPLOT C - 5 / DI,B - 40 / DI TO C + 5 / DI,B - 40 / DI TO C + 15 / DI,B - 30 / DI TO C,B - 40 / DI TO C - 15 / DI,B - 30 / DI TO C - 5 / DI + .5,B - 40 / DI
268  GOTO 1700
269  HPLOT C - 20 / DI,79 - YY%(DI) TO C - 20 / DI,B - 88 / DI TO C - 10 / DI,B - 83 / DI TO C + 10 / DI,B - 83 / DI TO C + 20 / DI,B - 88 / DI TO C + 20 / DI,79 - YY%(DI) TO C - 20 / DI,79 - YY%(DI)
270  HPLOT C - 20 / DI,B - 88 / DI TO C - 30 / DI,B - 83 / DI TO C - 30 / DI,B - 78 / DI
271   HPLOT C + 20 / DI,B - 88 / DI TO C + 30 / DI,B - 83 / DI TO C + 40 / DI,B - 83 / DI
272  HPLOT C - 15 / DI,B - 86 / DI TO C - 20 / DI,B - 83 / DI TO C - 20 / DI,B - 78 / DI TO C - 30 / DI,B - 73 / DI TO C - 30 / DI,B - 68 / DI TO C - 20 / DI,B - 63 / DI
273  HPLOT C - 10 / DI,B - 83 / DI TO C - 10 / DI,B - 58 / DI TO C,B - 50 / DI
274   HPLOT C + 10 / DI,B - 83 / DI TO C + 10 / DI,B - 78 / DI TO C + 20 / DI,B - 73 / DI TO C + 20 / DI,B - 40 / DI
275  HPLOT C + 15 / DI,B - 85 / DI TO C + 20 / DI,B - 78 / DI TO C + 30 / DI,B - 76 / DI TO C + 30 / DI,B - 60 / DI
276  HPLOT C,B - 83 / DI TO C,B - 73 / DI TO C + 10 / DI,B - 68 / DI TO C + 10 / DI,B - 63 / DI TO C,B - 58 / DI
277  GOTO 1700
278  HPLOT C + 5 / DI + .5,B - 10 / DI TO C - 5 / DI + .5,B - 10 / DI TO C,B - 15 / DI TO C + 10 / DI,B - 20 / DI TO C + 5 / DI + .5,B - 15 / DI TO C + 5 / DI + .5,B - 10 / DI
279  HPLOT TO C + 7 / DI + .5,B - 6 / DI TO C + 5 / DI + .5,B - 3 / DI TO C - 5 / DI + .5,B - 3 / DI TO C - 7 / DI + .5,B - 6 / DI TO C - 5 / DI + .5,B - 10 / DI
280  HPLOT C + 2 / DI + .5,B - 3 / DI TO C + 5 / DI + .5,B TO C + 8 / DI ,B
281   HPLOT C - 2 / DI + .5,B - 3 / DI TO C - 5 / DI + .5,B TO C - 8 / DI,B
282   HPLOT C + 3 / DI + .5,B - 8 / DI
283  HPLOT C - 3 / DI + .5,B - 8 / DI
284   HPLOT C + 3 / DI + .5,B - 5 / DI TO C - 3 / DI + .5,B - 5 / DI
285  GOTO 1700
286  HPLOT 139 - 10 / DI,PE%(DI,3) TO 139 - 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 10 / DI,PE%(DI,3) TO 139 - 10 / DI,PE%(DI,3)
287  HPLOT 139 - 10 / DI,PE%(DI,3) - 10 / DI TO 139 - 5 / DI,PE%(DI,3) - 15 / DI TO 139 + 15 / DI,PE%(DI,3) - 15 / DI TO 139 + 15 / DI,PE%(DI,3) - 5 / DI TO 139 + 10 / DI,PE%(DI,3)
288  HPLOT 139 + 10 / DI,PE%(DI,3) - 10 / DI TO 139 + 15 / DI,PE%( DI,3) - 15 / DI
289  GOTO 1700
290  HPLOT C - 14 / DI,B - 46 / DI TO C - 12 / DI,B - 37 / DI TO C - 20 / DI,B - 32 / DI TO C - 30 / DI,B - 32 / DI
291  HPLOT TO C - 22 / DI,B - 24 / DI TO C - 40 / DI,B - 17 / DI TO C - 40 / DI,B - 7 / DI TO C - 38 / DI ,B - 5 / DI TO C - 40 / DI,B - 3 / DI TO C - 40 / DI,B
292  HPLOT TO C - 36 / DI,B TO C - 34 / DI,B - 2 / DI TO C - 32 / DI,B TO C - 28 / DI,B TO C - 28 / DI,B - 3 / DI TO C - 30 / DI,B - 5 / DI TO C - 28 / DI,B - 7 / DI TO C - 28 / DI,B - 15 / DI TO C,B - 27 / DI
293  HPLOT C + 14 / DI,B - 46 / DI TO C + 12 / DI,B - 37 / DI TO C + 20 / DI,B - 32 / DI TO C + 30 / DI,B - 32 / DI
294  HPLOT TO C + 22 / DI,B - 24 / DI TO C + 40 / DI,B - 17 / DI TO C + 40 / DI,B - 7 / DI TO C + 38 / DI ,B - 5 / DI TO C + 40 / DI,B - 3 / DI TO C + 40 / DI,B
295  HPLOT TO C + 36 / DI,B TO C + 34 / DI,B - 2 / DI TO C + 32 / DI,B TO C + 28 / DI,B TO C + 28 / DI,B - 3 / DI TO C + 30 / DI,B - 5 / DI TO C + 28 / DI,B - 7 / DI TO C + 28 / DI,B - 15 / DI TO C,B - 27 / DI
296  HPLOT C + 6 / DI,B - 48 / DI TO C + 38 / DI,B - 41 / DI TO C + 40 / DI,B - 42 / DI TO C + 18 / DI,B - 56 / DI
297  HPLOT TO C + 12 / DI,B - 56 / DI TO C + 10 / DI,B - 57 / DI TO C + 8 / DI,B - 56 / DI TO C - 8 / DI, B - 56 / DI TO C - 10 / DI,B - 58 / DI TO C + 14 / DI,B - 58 / DI TO C + 16 / DI,B - 59 / DI
298  HPLOT TO C + 8 / DI,B - 63 / DI TO C + 6 / DI,B - 63 / DI TO C + 2 / DI + .5,B - 70 / DI TO C + 2 / DI + .5,B - 63 / DI
299  HPLOT TO C - 2 / DI + .5,B - 63 / DI TO C - 2 / DI + .5,B - 70 / DI TO C - 6 / DI,B - 63 / DI TO C - 8 / DI,B - 63 / DI TO C - 16 / DI,B - 59 / DI TO C - 14 / DI,B - 58 / DI
300  HPLOT TO C - 10 / DI,B - 57 / DI TO C - 12 / DI,B - 56 / DI TO C - 18 / DI,B - 56 / DI TO C - 36 / DI,B - 47 / DI
301  HPLOT TO C - 36 / DI,B - 39 / DI TO C - 28 / DI,B - 41 / DI TO C - 28 / DI,B - 46 / DI TO C - 20 / DI,B - 50 / DI TO C - 18 / DI,B - 50 / DI TO C - 14 / DI,B - 46 / DI
302  GOTO 3040
303  HPLOT C + 6 / DI,B - 60 / DI TO C + 30 / DI,B - 90 / DI TO C + 60 / DI,B - 30 / DI TO C + 60 / DI,B - 10 / DI TO C + 30 / DI,B - 40 / DI TO C + 15 / DI,B - 40 / DI
304  HPLOT C - 6 / DI,B - 60 / DI TO C - 30 / DI,B - 90 / DI TO C - 60 / DI,B - 30 / DI TO C - 60 / DI,B - 10 / DI TO C - 30 / DI,B - 40 / DI TO C - 15 / DI,B - 40 / DI
305  HPLOT C,B - 25 / DI TO C + 6 / DI,B - 25 / DI TO C + 10 / DI,B - 20 / DI TO C + 12 / DI,B - 10 / DI TO C + 10 / DI,B - 6 / DI TO C + 10 / DI,B TO C + 14 / DI,B TO C + 15 / DI,B - 5 / DI TO C + 16 / DI,B TO C + 20 / DI,B
306  HPLOT TO C + 20 / DI,B - 6 / DI TO C + 18 / DI,B - 10 / DI TO C + 18 / DI,B - 20 / DI TO C + 15 / DI,B - 30 / DI TO C + 15 / DI,B - 45 / DI TO C + 40 / DI,B - 60 / DI TO C + 40 / DI,B - 70 / DI
307  HPLOT TO C + 10 / DI,B - 55 / DI TO C + 6 / DI,B - 60 / DI TO C + 10 / DI,B - 74 / DI TO C + 6 / DI,B - 80 / DI TO C + 4 / DI + .5,B - 80 / DI TO C + 3 / DI + .5,B - 82 / DI TO C + 2 / DI + .5,B - 80 / DI TO C,B - 80 / DI
308  HPLOT C,B - 25 / DI TO C - 6 / DI,B - 25 / DI TO C - 10 / DI,B - 20 / DI TO C - 12 / DI,B - 10 / DI TO C - 10 / DI,B - 6 / DI TO C - 10 / DI,B TO C - 14 / DI,B TO C - 15 / DI,B - 5 / DI TO C - 16 / DI,B TO C - 20 / DI,B
309  HPLOT TO C - 20 / DI,B - 6 / DI TO C - 18 / DI,B - 10 / DI TO C - 18 / DI,B - 20 / DI TO C - 15 / DI,B - 30 / DI TO C - 15 / DI,B - 45 / DI TO C - 40 / DI,B - 60 / DI TO C - 40 / DI,B - 70 / DI
310  HPLOT TO C - 10 / DI,B - 55 / DI TO C - 6 / DI,B - 60 / DI TO C - 10 / DI,B - 74 / DI TO C - 6 / DI,B - 80 / DI TO C - 4 / DI + .5,B - 80 / DI TO C - 3 / DI + .5,B - 82 / DI TO C - 2 / DI + .5,B - 80 / DI TO C,B - 80 / DI
311  HPLOT C - 6 / DI,B - 25 / DI TO C,B - 6 / DI TO C + 10 / DI,B TO C + 4 / DI + .5,B - 8 / DI TO C + 6 / DI,B - 25 / DI
312        HPLOT C - 40 / DI, B - 64 / DI TO C - 40 / DI,B - 90 / DI TO C - 52 / DI,B - 80 / DI TO C - 52 / DI,B - 40 / DI
313  HPLOT C + 40 / DI,B - 86 / DI TO C + 38 / DI,B - 92 / DI TO C + 42 / DI,B - 92 / DI TO C + 40 / DI,B - 86 / DI TO C + 40 / DI,B - 50 / DI
314  HPLOT C + 4 / DI + .5,B - 70 / DI TO C + 6 / DI,B - 74 / DI
315   HPLOT C - 4 / DI + .5,B - 70 / DI TO C - 6 / DI,B - 74 / DI
316   HPLOT C,B - 64 / DI TO C,B - 60 / DI
317  GOTO 1700
318  IF EN = 1 THEN EN = 0
319  RETURN
320  DI = DI + 1
321   GOTO 620
322  ZZ = RND ( - ABS (LN) - TX * 10 - TY * 1000 + IO * 31.4)
323  FOR X = 1 TO 9
324   FOR Y = 1 TO 9
325  DN%(X,Y) = 0
326   NEXT
327   NEXT
328  FOR X = 0 TO 10
329  DN%(X,0) = 1
330  DN%(X,10) = 1
331  DN%(0,X) = 1
332  DN%(10, X) = 1
333   NEXT
334  FOR X = 2 TO 8 STEP 2
335   FOR Y = 1 TO 9
336  DN%(X,Y) = 1
337  DN%(Y,X) = 1
338   NEXT
339   NEXT
340  FOR X = 2 TO 8 STEP 2
341   FOR Y = 1 TO 9 STEP 2
342  IF RND (1) > .95 THEN DN%(X,Y) = 2
343  IF RND (1) > .95 THEN DN%(Y,X) = 2
344  IF RND (1) > .6 THEN DN%(Y,X) = 3
345  IF RND (1) > .6 THEN DN%(X,Y) = 3
346  IF RND (1) > .6 THEN DN%(X,Y) = 4
347  IF RND (1) > .6 THEN DN%(Y,X) = 4
348  IF RND (1) > .97 THEN DN%(Y,X) = 9
349  IF RND (1) > .97 THEN DN%(X,Y) = 9
350  IF RND (1) > .94 THEN DN%(X,Y) = 5
351  IF RND (1) > .94 THEN DN%(Y,X) = 5
352  NEXT
353   NEXT
354  DN%(2,1) = 0
355   IF IO / 2 = INT (IN / 2) THEN DN%(7,3) = 7
356  DN%(3,7) = 8
357  IF IO / 2 < > INT (IN / 2) THEN DN%(7,3) = 8
358  DN%(3,7) = 7
359  IF IO = 1 THEN DN%(1,1) = 8
360  DN%(7,3) = 0
361  GOSUB 2930
362  RETURN
363  VTAB (24)
364   PRINT "COMMAND? ";
365   CALL - 868
366  X = PEEK (-16384)
367   IF X < 128 THEN 1940
368  Q = FRE (0)
369  POKE - 16368,0
370  IF X = 141 THEN ON SGN (IN) + 1 GOTO 2170,2190
371  IF X = 149 THEN ON SGN (IN) + 1 GOTO 2260,2280
372  IF X = 136 THEN ON SGN (IN) + 1 GOTO 2310,2330
373  IF X = 175 THEN ON SGN (IN) + 1 GOTO 2360,2380
374  IF X = 216 THEN ON SGN (IN) + 1 GOTO 2390,2430
375  IF X = 193 OR X = 155 THEN ON SGN (IN) + 1 GOTO 2520,2530
376  IF X = 160 THEN PRINT "PASS"
377   GOTO 2090
378  IF X = 211 THEN 2920
379  IF X = 208 THEN IF PA = 1 THEN PA = 0
380   PRINT "PAUSE OFF"
381   GOTO 1930
382  IF X = 208 THEN IF PA = 0 THEN PA = 1
383   PRINT "PAUSE ON"
384   GOTO 1930
385  PRINT "HUH?"
386   GOTO 1930
387  REM ------------------ STARVE ------------------
388  PW(0) = PW(0) - 1 + SGN (IN) * .9
389   IF PW(0) < 0 THEN C(0) = 0
390   PRINT
391   PRINT "YOU HAVE STARVED!!!!!"
392   GOTO 2120
393  POKE 33,40
394   VTAB (22)
395   HTAB (30)
396   PRINT "FOOD=";PW(0);
397   CALL - 868
398   VTAB (23)
399   HTAB (30)
400   PRINT "H.P.=";C(0);
401   CALL - 868
402   VTAB (24)
403   HTAB (30)
404   PRINT "GOLD=";C(5);
405   CALL - 868
406   POKE 33,29
407   HTAB (1)
408  PW(0) = INT (PW(0) * 10) / 10
409  IF C(0) < = 0 THEN 3410
410  IF IO > 0 THEN GOSUB 3090
411   IF C(0) < = 0 THEN 2120
412  POKE 33,40
413   VTAB (22)
414   HTAB (30)
415   PRINT "FOOD=";PW(0);
416   CALL - 868
417   VTAB (23)
418   HTAB (30)
419   PRINT "H.P.=";C(0);
420   CALL - 868
421   VTAB (24)
422   HTAB (30)
423   PRINT "GOLD=";C(5);
424   CALL - 868
425   POKE 33,29
426   HTAB (1)
427  IF IO = 0 THEN GOSUB 470
428   GOTO 1930
429  IF IO > 0 THEN GOSUB 610
430   GOTO 1930
431  PRINT "NORTH"
432   IF TE%(TX,TY - 1) = 1 THEN PRINT "YOU CAN'T PASS THE MOUNTAINS"
433   GOTO 2090
434  TY = TY - 1
435   GOTO 2090
436  IF DN%(PX + DX,PY + DY) < > 1 AND DN%(PX + DX,PY + DY) < 10 THEN PX = PX + DX
437  PY = PY + DY
438  PRINT "FORWARD"
439  IF DN%(PX,PY) = 2 THEN PRINT "AAARRRGGGHHH!!! A TRAP!"
440  C(0)= C( 0) - INT ( RND (1) * IO + 3)
441  MR = 1
442  IN = IO + 1
443   PRINT "FALLING TO LEVEL ";IN
444   GOSUB 1720
445   GOTO 2090
446  Z = 0
447  IF DN%(PX,PY) = 5 THEN DN%(PX,PY) = 0
448   PRINT "GOLD!!!!!"
449  Z = INT ( RND (1) * 5 * IO + IN)
450   PRINT Z;"-PIECES OF EIGHT"
451  C(5) = C( 5) + Z
452  IF Z > 0 THEN Z = INT ( RND (1) * 6)
453   PRINT "AND A ";W$(Z)
454  PW(Z) = PW(Z) + 1
455   GOTO 2090
456  GOTO 2090
457  PRINT "EAST"
458   IF TE%(TX + 1,TY) = 1 THEN PRINT "YOU CAN'T PASS T HE MOUNTAINS"
459   GOTO 2090
460  TX = TX + 1
461   GOTO 2090
462  PRINT "TURN RIGHT"
463  IF DX < > 0 THEN DY = DX
464  DX = 0
465   GOTO 2090
466  DX = - DY
467  DY = 0
468   GOTO 2090
469  PRINT "WEST"
470   IF TE%(TX - 1,TY) = 1 THEN PRINT "YOU CAN'T PASS T HE MOUNTAINS"
471   GOTO 2090
472  TX = TX - 1
473   GOTO 2090
474  PRINT "TURN LE"
475  IF DX < > 0 THEN DY = - DX
476  DX = 0
477   GOTO 2090
478  DX = DY
479  DY = 0
480   GOTO 2090
481  PRINT "SOUTH"
482   IF TE%(TX,TY + 1) = 1 THEN PRINT "YOU CAN'T PASS THE MOUNTAINS"
483   GOTO 2090
484  TY = TY + 1
485   GOTO 2090
486  PRINT "TURN AROUND"
487  DX = - DX
488  DY = - DY
489   GOTO 2090
490  IF TE%(TX,TY) = 3 THEN GOSUB 3960
491   GOSUB 4060
492   GOTO 2090
493  IF TE%(TX,TY) = 4 AND IO = 0 THEN PRINT "GO DUNGEON"
494   PRINT "P LEASE WAIT "
495  IN = 1
496   GOSUB 1720
497  DX = 1
498  DY = 0
499  PX = 1
500  PY = 1
501   GOTO 2090
502  IF TE%(TX,TY) = 5 THEN 3510
503  PRINT "HUH?"
504   GOTO 1930
505  IF DN%(PX,PY) < > 7 AND DN%(PX,PY) < > 9 THEN 2460
506  PRINT "GO DOWN TO LEVEL ";IN + 1
507  IO = IO + 1
508   GOSUB 1720
509  MR = 1
510   GOTO 2090
511  IF DN%(PX,PY) < > 8 THEN PRINT "HUH?"
512   GOTO 2090
513  IF IO = 1 THEN PRINT "LEAVE DUNGEON"
514  IN = 0
515   GOTO 2500
516  PRINT "GO UP TO LEVEL ";IN - 1
517  IO = IO - 1
518   GOSUB 1720
519  MR = 1
520  IF IO = 0 THEN PRINT "THOU HAST GAINED"
521   PRINT LK;" HIT POINTS"
522  C (0) = C(0) + LK
523  LK = 0
524  GOTO 2090
525  GOTO 2090
526  MN = 0
527  DA = 0
528   PRINT "ATTACK"
529   PRINT "WHICH WEAPON ";
530   GET Q$
531  IF Q$ = "R" THEN DA = 10
532   PRINT "RAPIER"
533   IF PW(1) < 1 THEN PRINT "NOT OWNED"
534   GOTO 2530
535  IF Q$ = "A" THEN DA = 5
536   PRINT "AXE"
537   IF PW(2) < 1 THEN PRINT "N OT OWNED"
538   GOTO 2530
539  IF Q$ = "S" THEN DA = 1
540   PRINT "SHIELD"
541   IF PW(3) < 1 THEN PRINT "NOT OWNED"
542   GOTO 2530
543  IF Q$ = "B" THEN DA = 4
544   PRINT "BOW"
545   IF PW(4) < 1 THEN PRINT "N OT OWNED"
546   GOTO 2530
547  IF Q$ = "M" THEN PRINT "MAGIC AMULET"
548   GOTO 2790
549  IF Q$ = "B" AND PT$ = "M" THEN PRINT "MAGES CAN'T USE BOWS!"
550   GOTO 2530
551  IF Q$ = "R" AND PT$ = "M" THEN PRINT "MAGES CAN'T USE RAPIERS!"
552   GOTO 2530
553  IF DA = 0 THEN PRINT "HANDS"
554  IF DA = 5 OR DA = 4 THEN 2740
555  MN = DN%(PX + DX,PY + DY) / 10
556  MN = INT (MN)
557  IF MN < 1 OR C(2) - RND (1) * 25 < MN + IO THEN PRINT "YOU MISSED"
558   GOTO 2720
559  PRINT "HIT!!! "
560  DA = RND (1) * DA + C(1) / 5
561  MZ%(MN,1) = MZ%( MN,1) - DA
562  PRINT M$(MN);"'S HIT POINTS=";MZ%(MN,1)
563  IF MZ%(MN,1) < 1 THEN PRINT "THOU HAST KILLED A ";M$(MN)
564   PRINT " THOU SHALT RECEIVE"
565  DA = INT (MN + IN)
566   PRINT DA;" PIECES OF EIGHT"
567  IF MZ%(MN,1) < 1 THEN C(5) = INT (C(5) + DA)
568  DN%(ML%(MN,0),ML%(MN,1)) = DN%(ML%(MN,0),ML%(MN,1)) - 10 * MN
569  MZ%(MN,0) = 0
570  LK = LK + INT (MN * IO / 2)
571   IF MN = TASK THEN TASK = - TASK
572  IF PA = 1 THEN PRINT "-CR- TO CONT. ";
573   INPUT Q$
574  GOTO 2090
575  IF DA = 5 THEN PRINT "TO THROW OR SWING
576  ";
577   GET Q$
578   IF Q$ < > " T" THEN PRINT "SWING"
579   GOTO 2630
580  IF DA = 5 THEN PRINT "THROW"
581  PW(2) = PW(2) - 1
582  FOR Y = 1 TO 5
583   IF PX + DX * Y < 1 OR PX + DX * Y > 9 OR PY + DY * Y > 9 OR PY + DY * Y < 0 THEN 2640
584  MN = DN%(PX + DX * Y,PY + DY * Y)
585  MN = INT (MN / 10)
586   IF MN > 0 THEN 2640
587  NEXT
588   GOTO 2640
589  IF PW(5) < 1 THEN PRINT "NONE OWNED"
590   GOTO 2530
591  IF PT$ = "F" THEN Q = INT ( RND (1) * 4 + 1)
592   GOTO 2830
593  PRINT "1-LADDER-UP","2-LADDER-DN"
594   PRINT "3-KILL","4-BAD??"
595   PRINT "CHOICE ";
596   GET Q$
597  Q = VAL (Q$)
598   PRINT Q
599   IF Q < 1 OR Q > 4 THEN 2810
600  IF RND (1) > .75 THEN PRINT "LAST CHARGE ON THIS AMULET!"
601  PW(5) = PW(5) - 1
602  ON Q GOTO 2840,2850,2860,2870
603  PRINT "LADDER UP"
604  DN%(PX,PY) = 8
605   GOTO 2090
606  PRINT "LADDER DOWN"
607  DN%(PX,PY) = 7
608   GOTO 2090
609  PRINT "MAGIC ATTACK"
610  DA = 10 + IN
611   GOTO 2760
612  ON INT ( RND (1) * 3 + 1) GOTO 2880,2900,2910
613  PRINT "YOU HAVE BEEN TURNED"
614   PRINT "INTO A TOAD!"
615  FOR Z2 = 1 TO 4
616  C(Z2) = 3
617  C(Z2) = 3
618   NEXT Z2
619   GOTO 2090
620  PRINT "YOU HAVE BEEN TURNED"
621   PRINT "INTO A LIZARD MAN"
622   FOR Y = 0 TO 4
623  C(Y) = INT (C(Y) * 2.5)
624   NEXT
625   GOTO 2090
626  PRINT "BACKFIRE"
627  C(0) = C(0) / 2
628   GOTO 2090
629  GOSUB 3960
630   HOME
631   PRINT "PRESS -CR- TO CONTINUE";
632   INPUT Q$
633   TEXT
634   HOME
635   GOTO 2090
636  NM = 0
637   FOR X = 1 TO 10
638  MZ%(X,0) = 0
639  MZ%(X,1) = X + 3 + IN
640  IF X - 2 > IO OR RND (1) > .4 THEN 3030
641  ML%(X,0) = INT ( RND (1) * 9 + 1)
642  ML%(X,1) = INT ( RND (1) * 9 + 1)
643  IF DN%(ML%(X,0),ML%(X,1)) < > 0 THEN 2960
644  IF ML%(X,0) = PX AND ML%(X,1) = PY THEN 2960
645  DN%(ML%(X,0),ML%(X,1)) = X * 10
646  MZ%(X,0) = 1
647  NM = NM + 1
648  MZ%(X,1) = X * 2 + IO * 2 * LV
649  NEXT
650   RETURN
651  HPLOT C - 28 / DI,B - 41 / DI TO C + 30 / DI,B - 55 / DI
652   HPLOT C + 28 / DI,B - 58 / DI TO C + 22 / DI,B - 56 / DI
653  HPLOT TO C + 22 / DI,B - 53 / DI TO C + 28 / DI,B - 52 / DI TO C + 34 / DI,B - 54 / DI
654   HPLOT C + 20 / DI,B - 50 / DI TO C + 26 / DI,B - 47 / DI
655  HPLOT C + 10 / DI,B - 58 / DI TO C + 10 / DI,B - 61 / DI TO C + 4 / DI,B - 58 / DI
656   HPLOT C - 10 / DI,B - 58 / DI TO C - 10 / DI,B - 61 / DI
657  HPLOT TO C - 4 / DI,B - 58 / DI
658   HPLOT C + 40 / DI,B - 9 / DI TO C + 50 / DI,B - 12 / DI TO C + 40 / DI,B - 7 / DI
659  HPLOT C - 8 / DI,B - 25 / DI TO C + 6 / DI,B - 7 / DI TO C + 28 / DI,B - 7 / DI TO C + 28 / DI,B - 9 / DI TO C + 20 / DI,B - 9 / DI TO C + 6 / DI,B - 25 / DI
660   GOTO 1700
661  FOR MM = 1 TO 10
662   IF MZ%(MM,0) = 0 THEN 3390
663  RA = SQR ((PX - ML%(MM,0)) ^ 2 + (PY - ML%(MM,1)) ^ 2)
664  IF MZ%(MM,1) < IO * LV THEN 3140
665  IF RA < 1.3 THEN 3290
666  IF MM = 8 AND RA < 3 THEN 3390
667  X1 = SGN (PX - ML%(MM,0))
668  Y1 = SGN (PY - ML%(MM,1))
669  IF MZ%(MM,1) < IO * LV THEN X1 = - X1
670  Y1 = - Y1
671  IF Y1 = 0 THEN 3190
672  D = DN%(ML%(MM,0),(ML%(MM,1) + Y1 + .5))
673   IF D = 1 OR D > 9 OR D = 2 THEN 3190
674  X1 = 0
675   GOTO 3210
676  Y1 = 0
677   IF X1 = 0 THEN 3210
678  D = DN%((ML%(MM,0) + X1 + .5),ML%(MM,1))
679   IF D = 1 OR D > 9 OR D = 2 THEN X1 = 0
680   GOTO 3250
681  DN%(ML%(MM,0),ML%(MM,1)) = DN%(ML%(MM,0),ML%(MM,1)) - 10 * MM
682  IF ML%(MM,0) + X1 = PX AND ML%(MM,1) + Y1 = PY THEN 3390
683  ML%(MM,0) = ML%(MM,0) + X1
684  ML%(MM,1) = ML%(MM,1) + Y1
685  DN%(ML%(MM,0),ML%(MM,1)) = (DN%(ML%(MM,0),ML%(MM,1)) + 10 * MM + .5)
686  IF X1 < > 0 OR Y1 < > 0 THEN 3390
687  IF MZ%(MM,1) < IO * LV AND RA < 1.3 THEN 3290
688  IF MZ%(MM,1) < IO * LV THEN MZ%(MM,1) = MZ%(MM,1) + MM + IN
689  GOTO 3390
690  IF MM = 2 OR MM = 7 THEN 3350
691  PRINT "YOU ARE BEING ATTACKED"
692   PRINT "BY A ";M$(MM)
693  IF RND (1) * 20 - SGN (PW(3)) - C(3) + MM + IO < 0 THEN PRINT " MISSED"
694   GOTO 3330
695  PRINT "HIT"
696  C(0) = C(0) - INT ( RND (1) * MM + IN)
697  IF PA = 1 THEN PRINT "-CR- TO CONT. ";
698   INPUT Q$
699  GOTO 3390
700  IF RND (1) < .5 THEN 3300
701  IF MM = 7 THEN PW(0) = INT (PW(0) / 2)
702   PRINT "A GREMLIN STOLE SO ME FOOD"
703   GOTO 3330
704  ZZ = INT ( RND (1) * 6)
705   IF PW(ZZ) < 1 THEN 3370
706  PRINT "A THIEF STOLE A ";W$(ZZ)
707  PW(ZZ) = PW(ZZ) - 1
708   GOTO 3330
709  NEXT
710   RETURN
711  REM ------------------ DIE ------------------
712  POKE 33,40
713   PRINT
714   PRINT
715   PRINT "    WE MOURN THE PASSING OF "
716  IF LEN (PN$) > 22 THEN PN$ = ""
717  IF PN$ = "" THEN PN$ = "THE PEASANT"
718  PN$ = PN$ + " AND HIS COMPUTER"
719  HTAB (20 - INT ( LEN (PN$) / 2))
720   PRINT PN$
721  PRINT " TO INVOKE A MIRACLE OF RESSURECTION"
722  PRINT "       <HIT ESC KEY>";
723  IF PEEK ( - 16384) = 155 THEN 10
724  GOTO 3480
725  REM ------------------ LORD BRITISH'S CASTLE------------------
726  HOME
727   TEXT
728   HOME
729  CALL 62450
730  IF PN$ < > "" THEN 3620
731  PRINT
732   PRINT
733   PRINT "   WELCOME PEASANT INTO THE HALLS OF"
734   PRINT "THE MIGHTY LORD BRITISH. HEREIN THOU MAYCHOOSE TO DARE BATTLE WITH THE EVIL"
735   PRINT "CREATURES OF THE DEPTHS, FOR GREAT"
736   PRINT "REWARD !"
737  PRINT
738   PRINT "WHAT IS THY NAME PEASANT ";
739   INPUT PN$
740  PRINT "DOEST THOU WISH FOR GRAND ADVENTURE ? ";
741   GET Q$
742   IF Q$ < > "Y" THEN PRINT
743   PRINT "THEN LEAVE AND BEGONE!"
744  PN$ = ""
745   PRINT
746   PRINT "     PRESS -SPACE- TO CONT.";
747   GET Q$
748   GOTO 2090
749  PRINT
750  PRINT
751   PRINT "GOOD! THOU SHALT TRY TO BECOME A "
752   PRINT "KNIGHT!! !"
753   PRINT
754   PRINT "THY FIRST TASK IS TO GO INTO THE"
755   PRINT "DUNGEONS AND TO RETURN ONLY AFTER"
756   PRINT "KILLING A(N) ";
757  TASK = INT (C(4 ) / 3)
758   PRINT M$(TASK)
759  PRINT
760   PRINT "   GO NOW UPON THIS QUEST, AND MAY"
761   PRINT "LADY LUCK BE FAIR UNTO YOU....."
762   PRINT ".....ALSO I, BRITISH, HAVE INCREASED"
763   PRINT "EACH OF THY ATTRIBUTES BY ONE!"
764  PRINT
765   PRINT "     PRESS -SPACE- TO CONT.";
766   GET Q$
767   FOR X = 0 TO 5
768  C(X) = C(X) + 1
769   NEXT
770   HOME
771   GOTO 2090
772  REM ------------------ RETURN TO CASTLE ------------------
773  IF TASK > 0 THEN PRINT
774   PRINT
775   PRINT PN$;" WHY HAST THOU RETURNED?"
776   PRINT "THOU MUST KILL A(N) ";M$(TASK)
777   PRINT "GO NOW AND COMPLETE THY QUEST!"
778   PRINT
779   PRINT "     PRESS -SPACE- TO CONT.";
780   GET Q$
781   HOME
782   GOTO 2090
783  PRINT
784   PRINT
785   PRINT
786   PRINT "AAHH!!.....";PN$
787   PRINT
788   PRINT "THOU HAST ACOMPLISHED THY QUEST!"
789   IF ABS (TASK) = 10 THEN 3670
790  PRINT "UNFORTUNATELY, THIS IS NOT ENOUGH TO"
791   PRINT "BECOME A KNIGHT."
792  TASK = ABS (TASK) + 1
793   PRINT
794   PRINT "NOW THOU MUST KILL A(N) ";M$(TASK)
795  GOTO 3590
796  REM ------------------ WIN ------------------
797  TEXT
798   HOME
799   PRINT
800   PRINT
801   PRINT
802  PN$ = "LORD " + PN$
803   PRINT "   ";PN$;","
804  PRINT "    THOU HAST PROVED THYSELF WORTHY"
805   PRINT "OF KNIGHTHO OD, CONTINUE PLAY IF THOU"
806   PRINT "DOTH WISH, BUT THOU HAST ACOMPLISHED"
807   PRINT "THE MAIN OBJECTIVE OF THIS GAME..."
808  IF LV = 10 THEN 3720
809  PRINT
810   PRINT "  NOW MAYBE THOU ART FOOLHEARTY"
811   PRINT "ENOUGH TO TRY DIFFICULTY LEVEL ";LV + 1
812  GOTO 3600
813  PRINT
814   PRINT "...CALL CALIFORNIA PACIFIC COMPUTER"
815   PRINT "AT (415)-569-9126 TO REPORT THIS"
816   PRINT "AMAZING FEAT!"
817  GOTO 3600
818  REM ------------------  CHARACTER CREATE  ------------------
819  TEXT
820   HOME
821   VTAB (5)
822   INPUT "TYPE THY LUCKY NUMBER.....";Q$
823  LN = VAL (Q$)
824  VTAB (7)
825   INPUT "LEVEL OF PLAY (1-10)......";Q$
826  LV = INT ( VAL ( Q$))
827  IF LV < 1 OR LV > 10 THEN 3760
828  ZZ = RND (-ABS(LN))
829  DATA  "HIT POINTS.....","STRENGTH.......","DEXTERITY......","STA MINA........","WISDOM.........","GOLD..........."
830  DIM PW(5)
831  DIM C$(5)
832   FOR X = 0 TO 5
833   READ C$(X)
834   NEXT
835  DIM C(5)
836  DIM M$(10),ML%(10,1),MZ%(10,1)
837  DATA    "SKELETON","THIEF","GIANT RAT","ORC","VIPER","CARRION CRAWLER","GREMLIN","MIMIC","DAEMON","BALROG"
838  FOR X = 1 TO 10
839   READ M$(X)
840   NEXT
841  FOR X = 0 TO 5
842  C(X) = INT ( SQR ( RND (1)) * 21 + 4)
843   NEXT X
844  HOME
845   VTAB (8)
846   FOR X = 0 TO 5
847   PRINT C$(X),C(X)
848   NEXT
849   PRINT
850   PRINT "SHALT THOU PLAY WITH THESE QUALITIES?"
851   HTAB (20)
852   GET Q$
853   IF Q$ < > "Y" THEN 3860
854  VTAB (15)
855   PRINT
856   PRINT "AND SHALT THOU BE A FIGHTER OR A MAGE?"
857   HTAB (20)
858   GET PT$
859  IF PT$ = "M" OR PT$ = "F" THEN 3930
860  GOTO 3880
861  REM ------------------  END CHARACTER CREATE  ------------------
862  REM ------------------  BEGIN INITIALIZE ITEMS  ------------------
863  DIM W$(5)
864   DATA  "FOOD","RAPIER","AXE","SHIELD","BOW AND ARROWS ","MAGIC AMULET"
865   FOR X = 0 TO 5
866   READ W$(X)
867   NEXT
868  GOSUB 3960
869   GOSUB 4060
870   RETURN
871  REM ------------------  END INITIALIZE ITEMS  ------------------
872  TEXT
873   HOME
874   PRINT
875   PRINT
876   PRINT "   STAT'S       WEAPONS"
877   PRINT
878   FOR X = 0 TO 5
879   PRINT C$(X);C(X); TAB( 24);"0-";W$(X)
880   NEXT
881   POKE 34,12
882   HOME
883   POKE 35,15
884  VTAB (11)
885   HTAB (18)
886   PRINT "Q-QUIT"
887  IF PW(0) > 0 THEN CALL 62450
888  FOR Z = 0 TO 5
889   VTAB (5 + Z)
890   HTAB (25 - LEN ( STR$ (PW(Z))))
891   PRINT PW(Z);
892   NEXT
893  VTAB (17)
894   HTAB (5)
895   PRINT "PRICE";
896   HTAB (15)
897   PRINT "DAMAGE";
898   HTAB (25)
899   PRINT "ITEM"
900  FOR X = 0 TO 5
901   VTAB (19 + X)
902   HTAB (25)
903   PRINT W$(X)
904   NEXT
905  VTAB (19)
906   HTAB (5)
907   PRINT "1 FOR 10"
908   HTAB (15)
909   PRINT "N/A"
910   VTAB (20)
911   HTAB (5)
912   PRINT "8"
913   HTAB (15)
914   PRINT "1-10"
915   VTAB (21)
916   HTAB (5)
917   PRINT "5"
918   HTAB (15)
919   PRINT "1-5"
920  VTAB (22)
921   HTAB (5)
922   PRINT "6"
923   HTAB (15)
924   PRINT "1"
925   VTAB (23)
926   HTAB (5)
927   PRINT "3"
928   HTAB (15)
929   PRINT "1-4"
930   VTAB (24)
931   HTAB (5)
932   PRINT " 15"
933   HTAB (15)
934   PRINT "?????"
935   HOME
936  RETURN
937  REM ------------------  BEGIN ADVENTURE SHOP  ------------------
938  HOME
939   PRINT "WELCOME TO THE ADVENTURE SHOP"
940  PRINT "WHICH ITEM SHALT THOU BUY ";
941   GET Q$
942   IF Q$ = "Q" THEN PRINT
943   PRINT "BYE"
944   FOR Z = 1 TO 1000
945   NEXT
946   TEXT
947   HOME
948   RETURN
949  Z = - 1
950  IF Q$ = "F" THEN PRINT "FOOD"
951  Z = 0
952  P = 1
953  IF Q$ = "R" THEN PRINT "RAPIER"
954  Z = 1
955  P = 8
956  IF Q$ = "A" THEN PRINT "AXE"
957  Z = 2
958  P = 5
959  IF Q$ = "S" THEN PRINT "SHIELD"
960  Z = 3
961  P = 6
962  IF Q$ = "B" THEN PRINT "BOW"
963  Z = 4
964  P = 3
965        IF Q$ = "M" THEN PRINT "AMULET"
966  Z = 5
967  P = 15
968  IF Z = - 1 THEN PRINT Q$
969   PRINT "I'M SORRY WE DON'T HAVE THAT."
970   GOTO 4070
971  IF Q$ = "R" AND PT$ = "M" THEN PRINT "I'M SORRY MAGES"
972   PRINT "CAN'T USE THAT!"
973   GOTO 4070
974  IF Q$ = "B" AND PT$ = "M" THEN PRINT "I'M SORRY MAGES"
975   PRINT "CAN'T USE THAT!"
976   GOTO 4070
977  IF C(5) - P < 0 THEN PRINT "M'LORD THOU CAN NOT AFFORD THAT ITEM."
978   GOTO 4070
979    C(5) = C(5) - P
980    VTAB (10)
981    HTAB (16)
982    PRINT C(5);" "
983    VTAB (5 + Z)
984    HTAB (25 - LEN ( STR$ (PW(Z))))
985    PRINT PW(Z);
986    HTAB (1)
987    VTAB (14)
988    PRINT
989   GOTO 4070
990 REM ------------------  END ADVENTURE SHOP  ------------------
991
